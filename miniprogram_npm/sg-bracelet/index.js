module.exports = (function() {
var __MODS__ = {};
var __DEFINE__ = function(modId, func, req) { var m = { exports: {}, _tempexports: {} }; __MODS__[modId] = { status: 0, func: func, req: req, m: m }; };
var __REQUIRE__ = function(modId, source) { if(!__MODS__[modId]) return require(source); if(!__MODS__[modId].status) { var m = __MODS__[modId].m; m._exports = m._tempexports; var desp = Object.getOwnPropertyDescriptor(m, "exports"); if (desp && desp.configurable) Object.defineProperty(m, "exports", { set: function (val) { if(typeof val === "object" && val !== m._exports) { m._exports.__proto__ = val.__proto__; Object.keys(val).forEach(function (k) { m._exports[k] = val[k]; }); } m._tempexports = val }, get: function () { return m._tempexports; } }); __MODS__[modId].status = 1; __MODS__[modId].func(__MODS__[modId].req, m, m.exports); } return __MODS__[modId].m.exports; };
var __REQUIRE_WILDCARD__ = function(obj) { if(obj && obj.__esModule) { return obj; } else { var newObj = {}; if(obj != null) { for(var k in obj) { if (Object.prototype.hasOwnProperty.call(obj, k)) newObj[k] = obj[k]; } } newObj.default = obj; return newObj; } };
var __REQUIRE_DEFAULT__ = function(obj) { return obj && obj.__esModule ? obj.default : obj; };
__DEFINE__(1646653978718, function(require, module, exports) {
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).RollupLearn=t()}(this,(function(){var e;var t={errorCode:function(t,i,n,s){return e.errorCode(t,i,n,s)},getDeviceInfo:function(t){return e.getDeviceInfo(t)},Logger:{debug:function(...t){e.Logger.debug(...t)},info:function(...t){e.Logger.info(...t)},warn:function(...t){e.Logger.warn(...t)},error:function(...t){e.Logger.error(...t)}}};class i{constructor(){this.size=0,this.values=[]}build(){let e=new ArrayBuffer(this.size),t=new DataView(e);return this.values.forEach((({byteOffset:e,method:i,value:n,littleEndian:s,limitSize:a})=>{if("setBuffer"===i){let i=new DataView(n),s=i.byteLength;a&&(s=Math.min(a,s));for(let n=0;n<s;n++)t.setUint8(e+n,i.getUint8(n))}else"setUint8"===i?t[i](e,n):"setInt8"===i?n>0?t.setUint8(e,255&n):t.setUint8(e,n+256&255):"setUint24"===i?s?t.setUint32(e,n):t.setUint32(e,n<<8,!1):t[i](e,n,s)})),e}appendUint8(e){return this.values.push({byteOffset:this.size,method:"setUint8",value:e}),this.size++,this}appendUint16(e,t){return this.values.push({byteOffset:this.size,method:"setUint16",value:e,littleEndian:t}),this.size+=2,this}appendUint32(e,t){return this.values.push({byteOffset:this.size,method:"setUint32",value:e,littleEndian:t}),this.size+=4,this}appendBuffer(e,t){return this.values.push({byteOffset:this.size,method:"setBuffer",value:e,limitSize:t}),this.size+=t||e.byteLength,this}appendUint24(e,t){return this.values.push({byteOffset:this.size,method:"setUint24",value:e,littleEndian:t}),this.size+=3,this}appendInt8(e){return this.values.push({byteOffset:this.size,method:"setInt8",value:e}),this.size++,this}appendInt16(e,t){return this.values.push({byteOffset:this.size,method:"setInt16",value:e,littleEndian:t}),this.size+=2,this}appendFloat32(e,t){return this.values.push({byteOffset:this.size,method:"setFloat32",value:e,littleEndian:t}),this.size+=4,this}}const n=0,s=1,a=2,r=7,d=13,h=16,o=255;class p{constructor(e){this.tag=126,this.pages=e}getBytes(){let e=this.pages||[],t=new i;if(t.appendUint8(this.tag),t.appendUint8(e.length),e.length>0)for(let i=0;i<e.length;i++)t.appendUint8(e[i]);return t.build()}}function l(e){return!!(e.model&&e.model.indexOf("456")>=0)||(!!(e.model&&e.model.indexOf("460")>=0)||!!(e.model&&e.model.indexOf("437")>=0))}function c(e){return!!(e.model&&e.model.indexOf("456")>=0)}function u(e){return!!(e.model&&e.model.indexOf("460")>=0||e.model&&e.model.indexOf("437")>=0)&&(console.log("isWatch"),!0)}function g(e){return!!(e.model&&e.model.indexOf("437")>=0)}function U(e){return l(e)?5:3}function f(e,t){if(!e)return"";if("string"==typeof e)return e;let i=Array.prototype.map.call(new Uint8Array(e),(function(e){return("00"+e.toString(16)).slice(-2)}));if(t){let e=[];for(let t=0;t<i.length;t++)e.push(i[i.length-1-t]);return e.join("")}return i.join("")}function m(e,t){try{if("undefined"!=(i=e)&&i&&/[^\s]/.test(i)){let i=I(w(e).slice(0,t));if(i)for(;e.indexOf(i)<0&&i.length>0;)i=i.substring(0,i.length-1);return i}}catch(e){return""}var i;return""}function y(e){let t,i,n=[];for(let s=0;s<e.length;s++){t=e.charCodeAt(s),i=[];do{i.push(255&t),t>>=8}while(t);n=n.concat(i.reverse())}return n}function b(e){let t=e.toString(2);if(e<128)return e.toString(16);if(e<2048){t=("00000000000000000"+t).slice(-11);const e=parseInt("110"+t.substring(0,5),2),i=parseInt("10"+t.substring(5),2);return e.toString(16)+","+i.toString(16)}{t=("00000000000000000"+t).slice(-16);const e=parseInt("1110"+t.substring(0,4),2),i=parseInt("10"+t.substring(4,10),2),n=parseInt("10"+t.substring(10),2);return e.toString(16)+","+i.toString(16)+","+n.toString(16)}}function w(e){if(!e||0==e.length)return new ArrayBuffer(0);let t="";for(let i=0;i<e.length;i++)t+=","+b(e.charCodeAt(i));return new Uint8Array(t.match(/[\da-f]{2}/gi).map((function(e){return parseInt(e,16)}))).buffer}let v=wx.getSystemInfoSync();function S(){return v.platform.toLowerCase().indexOf("ios")>-1}let T=[];function I(e){return B(e)}function B(e){if(!e)return"";let t=new Uint8Array(e);var i,n,s,a,r,d;for(i="",s=t.length,n=0;n<s;)switch((a=t[n++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i+=String.fromCharCode(a);break;case 12:case 13:r=t[n++],i+=String.fromCharCode((31&a)<<6|63&r);break;case 14:r=t[n++],d=t[n++],i+=String.fromCharCode((15&a)<<12|(63&r)<<6|(63&d)<<0)}return i}function D(e,t=0){0===T.length&&function(){let e,t,i;for(t=0;t<256;t++){for(e=t,i=0;i<8;i++)1==(1&e)?e=3988292384^e>>>1:e>>>=1;T.push(e>>>0)}}();let i=0,n=t,s=new Uint8Array(e);for(i=0;i<s.byteLength;i++){let e=n^255&s[i];n=T[e]^n>>8}return n}function L(e){let t=Math.round(100*e);return(254<<24)+(16711680&t)+(65280&t)+(255&t)}function x(e,t,i){return e?(t.getUint8(i+2)<<16)+(t.getUint8(i+1)<<8)+t.getUint8(i):(t.getUint8(i)<<16)+(t.getUint8(i+1)<<8)+t.getUint8(i+2)}class R{constructor(e,t=0){this.values=[],this.parseSize=0,this.originalBuffer=e,this.index=t,this.parseSize=0,this.dataView=new DataView(e),this.index=t}build(e){if(!this.originalBuffer||this.originalBuffer.byteLength<=0)return null;e||(e={});let t=this.dataView;return this.values.forEach((({byteOffset:i,method:n,key:s,size:a,parseKey:r,littleEndian:d})=>{i+=this.parseSize;try{if("getHexString"===n)e[s]=f(this.originalBuffer.slice(i,i+a));else if("getStringByParse"===n){let t=e[r];this.parseSize+=t,e[s]=I(this.originalBuffer.slice(i,i+t))}else if("getString"===n)e[s]=I(this.originalBuffer.slice(i,i+a));else if("getBuffer"===n)e[s]=this.originalBuffer.slice(i,i+a);else if("getUint8"===n)e[s]=t.getUint8(i);else if("Uint24"===n)e[s]=x(d,t,i);else if("Uint8Array"===n)e[s]=[].slice.call(new Uint8Array(this.originalBuffer.slice(i,i+a)));else if("Uint16Array"===n){let t=[].slice.call(new Uint16Array(this.originalBuffer.slice(i,i+a)));e[s]=d?t:function(e){if(e&&e.length>0){let t=[];for(let i=0;i<e.length;i++){let n=e[i];n=((255&n)<<8)+(n>>8&255),t.push(n)}return t}return[]}(t)}else if("SFloat"===n){let n=t.getUint8(i),a=((15&n)<<8)+t.getUint8(i+1),r=(240&n)>>>4,d=r;(8&r)>0&&(d=r-16);let h=Math.pow(10,d);e[s]=a*h}else if("Float"===n){let n=t.getUint8(i),a=x(d,t,i+1),r=Math.pow(10,(15&n)-16);e[s]=a*r}else e[s]=t[n](i,d)}catch(e){}})),e}getUint24(e,t=!1){return this.values.push({byteOffset:this.index,method:"Uint24",key:e,littleEndian:t}),this.index+=3,this}getSFloat(e){return this.values.push({byteOffset:this.index,method:"SFloat",key:e}),this.index+=2,this}getFloat(e,t=!1){return this.values.push({byteOffset:this.index,method:"Float",key:e,littleEndian:t}),this.index+=4,this}getUint8Array(e,t){return this.values.push({byteOffset:this.index,size:t,method:"Uint8Array",key:e}),this.index+=t,this}getUint16Array(e,t,i=!1){return this.values.push({byteOffset:this.index,size:t,method:"Uint16Array",key:e,littleEndian:i}),this.index+=t,this}getUint8(e){return this.values.push({byteOffset:this.index,method:"getUint8",key:e}),this.index++,this}getUint16(e,t=!1){return this.values.push({byteOffset:this.index,method:"getUint16",key:e,littleEndian:t}),this.index+=2,this}getUint32(e,t=!1){return this.values.push({byteOffset:this.index,method:"getUint32",key:e,littleEndian:t}),this.index+=4,this}getBuffer(e,t){return this.values.push({byteOffset:this.index,size:t,method:"getBuffer",key:e}),this.index+=t,this}getByteOffset(){return this.index}getString(e,t){return this.values.push({byteOffset:this.index,size:t,method:"getString",key:e}),this.index+=t,this}getHexString(e,t){return this.values.push({byteOffset:this.index,size:t,method:"getHexString",key:e}),this.index+=t,this}getStringSizeByParse(e,t){return this.values.push({byteOffset:this.index,parseKey:t,method:"getStringByParse",key:e}),this}getIndex(){return this.index}readUint8(){let e=this.index;return this.index+=1,this.dataView.getUint8(e)}readUint16(e=!1){let t=this.index;return this.index+=2,this.dataView.getUint16(t,e)}readInt16(e=!1){let t=this.index;return this.index+=2,this.dataView.getInt16(t,e)}readUint24(e=!1){let t=this.index;return this.index+=3,x(e,this.dataView,t)}readUint32(e=!1){let t=this.index;return this.index+=4,this.dataView.getUint32(t,e)}readInt32(e=!1){let t=this.index;return this.index+=4,this.dataView.getInt32(t,e)}readSfloat(){let e=this.index,t=this.dataView;this.index+=2;let i=t.getUint8(e),n=(240&i)>>>4,s=n;return(8&n)>0&&(s=n-16),(((15&i)<<8)+t.getUint8(e+1))*Math.pow(10,s)}readFloat(e=!1){let t=this.index;this.index+=4;let i=this.dataView.getUint8(t);return x(e,this.dataView,t+1)*Math.pow(10,(15&i)-16)}readString(e){return I(this.readBuffer(e))}readBuffer(e){let t=this.index;return this.index+=e,this.dataView.buffer.slice(t,t+e)}}class C{constructor(e=[]){this.tag=251,this.dataType="SettingInfos",this.settings=e}getBytes(){let e=(new i).appendUint8(this.tag).appendUint8(this.settings.length);return this.settings.forEach((t=>{let i=this.getBytesWithItem(t);e.appendUint8(t.tag).appendUint8(i.byteLength).appendBuffer(i)})),e.build()}getBytesWithItem(e){let n=new i;switch(e.tag){case 1:case 3:case 2:case 32:case 4:case 5:case 6:case 7:case 8:case 9:case 38:case 37:n.appendUint8(e.value);break;case 16:case 45:n.appendUint32(e.value);break;case 54:n.appendUint16(e.value);break;case 19:let i=e,s=i.enable?2:0;s|=i.enableImmediately?1:0,n.appendUint8(s).appendUint8(i.startHour).appendUint8(i.startMinute).appendUint8(i.endHour).appendUint8(i.endMinute);break;case 11:let a=e;n.appendUint32(a.utc).appendUint8(a.timezone);break;case 52:{let t=e;n.appendInt8(t.list.length);for(let e=0;e<t.list.length;e++){let i=t.list[e];n.appendUint8(i.dialType),n.appendUint8(i.index)}break}case 40:{let t=e;n.appendUint8(t.length).appendUint8(t.period).appendUint8(t.lastBeginYear-1970).appendUint8(t.lastBeginMonth).appendUint8(t.lastBeginDay).appendUint8(t.lastEndYear-1970).appendUint8(t.lastEndMonth).appendUint8(t.lastEndDay).appendUint8(t.enable);break}case 41:case 42:{let t=e;n.appendUint8(t.enable).appendUint8(t.dayOfWarning).appendUint8(t.hour).appendUint8(t.minute);break}case 53:{let t=e;n.appendUint8(t.sleepTimeHour).appendUint8(t.sleepTimeMinute).appendUint8(t.awakeTimeHour).appendUint8(t.awakeTimeMinute).appendUint16(t.duration);break}case 33:e.list.forEach((e=>{n.appendUint8(e.reminderType).appendUint8(e.enable)}));break;case 10:{let t=e;n.appendUint8(t.index).appendUint8(6).appendUint8(0).appendUint8(0).appendUint8(0).appendUint8(63);break}case 15:{let t=e;n.appendUint8(t.type);break}default:t.Logger.warn(`${e.tag} 未实现该设置信息协议`)}return n.build()}parserBuf(e,t){let i=new R(e),n=i.readUint8(),s=[];for(let e=0;e<n;e++)s.push(this.parseTLV(i,t));return this.settings=s,this}parseTLV(e,i){let n,s=e.readUint8(),a=e.readUint8();switch(s){case 1:case 3:case 2:case 32:case 4:case 5:case 6:case 7:case 8:case 56:case 9:case 38:case 37:n={value:e.readUint8()};break;case 19:{let t=e.readUint8(),s=1==(t>>>1&1),a=1==(t>>>0&1);g(i)&&(s=a||s,a=!1),n={enable:s,enableImmediately:a,startHour:e.readUint8(),startMinute:e.readUint8(),endHour:e.readUint8(),endMinute:e.readUint8()};break}case 11:n={utc:e.readUint32(),timezone:e.readUint8()};break;case 21:case 55:{let t=e.readUint8(),i=t>>>1&1;n={enable:1&t,max:e.readUint8(),min:e.readUint8(),minEnable:i};break}case 10:n={value:e.readUint8()};break;case 22:{let t=e.readUint8(),i=e.readUint8(),s=e.readUint8(),a=e.readUint8(),r=e.readUint8(),d=e.readUint8(),h=e.readUint8(),o={};try{o={noDisturbEnable:e.readUint8(),noDisturbStartHour:e.readUint8(),noDisturbStartMinute:e.readUint8(),noDisturbEndHour:e.readUint8(),noDisturbEndMinute:e.readUint8()}}catch(e){}n=Object.assign({enable:t,startHour:i,startMinute:s,endHour:a,endMinute:r,frequency:d,repeatTime:h},o);break}case 57:n={enable:e.readUint8(),hour:e.readUint8(),minute:e.readUint8(),repeatTime:e.readUint8()};break;case 48:{let t=[],i=[];for(let n=0;n<a;n++){let n=e.readUint8();0!=(128&n)?(n&=127,127===n&&(n=255),i.push(n)):(127===n&&(n=255),t.push(n))}n={pages:t,supportPages:i};break}case 49:{let t=e.readUint8(),i=[],s=[];for(let n=0;n<t;n++){let t=e.readUint8();i.push(t)}for(let i=0;i<a-t-1;i++){let t=e.readUint8();s.push(t)}n={pages:i,supportPages:s};break}case 40:n={length:e.readUint8(),period:e.readUint8(),lastBeginYear:e.readUint8()+1970,lastBeginMonth:e.readUint8(),lastBeginDay:e.readUint8(),lastEndYear:e.readUint8()+1970,lastEndMonth:e.readUint8(),lastEndDay:e.readUint8(),enable:e.readUint8()};break;case 41:case 42:n={enable:e.readUint8(),dayOfWarning:e.readUint8(),hour:e.readUint8(),minute:e.readUint8()};break;case 53:n={sleepTimeHour:e.readUint8(),sleepTimeMinute:e.readUint8(),awakeTimeHour:e.readUint8(),awakeTimeMinute:e.readUint8(),duration:e.readUint16()};break;case 33:{let t=a/2,i=[];for(let n=0;n<t;n++){let t=e.readUint8(),n=e.readUint8();i.push({enable:n,reminderType:t})}n={list:i};break}case 58:n={duration:e.readUint8(),level0:e.readUint8(),level1:e.readUint8(),level2:e.readUint8(),level3:e.readUint8(),level4:e.readUint8()};break;case 35:n={enable:e.readUint8(),startHour:e.readUint8(),startMinute:e.readUint8(),endHour:e.readUint8(),endMinute:e.readUint8(),frequency:e.readUint8(),repeatTime:e.readUint8(),noDisturbEnable:e.readUint8(),noDisturbStartHour:e.readUint8(),noDisturbStartMinute:e.readUint8(),noDisturbEndHour:e.readUint8(),noDisturbEndMinute:e.readUint8()};break;default:t.Logger.error(`未实现设置信息解析协议 ${s} `)}return Object.assign({tag:s},n)}}class A{constructor(e){this.tag=163,this.dataType="EventReminder",this.events=e}getBytes(){let e=(new i).appendUint8(this.tag).appendUint8(this.events.length);return this.events.forEach((t=>{e.appendUint8(t.index);let i=w(m(t.desc,23));e.appendUint8(i.byteLength+1).appendBuffer(i).appendUint8(0);let n=0;n|=t.enable?1:0,t.napEnable&&(n|=2),t.lightSleepEnable&&(n|=4),t.isDelete&&(n|=128),e.appendUint8(n),t.napEnable&&t.enable&&e.appendUint8(t.napAlertTime),t.lightSleepEnable&&t.enable&&e.appendUint8(t.lightSleepAlertTime),e.appendUint8(t.hour).appendUint8(t.minute).appendUint8(t.repeatTime).appendUint8(t.vibrationType).appendUint8(t.vibrationTime).appendUint8(t.vibrationLevel1).appendUint8(t.vibrationLevel2)})),e.build()}parserBuf(e){let t=new R(e),i=t.readUint8(),n=[];for(let e=0;e<i;e++){let e=t.readUint8(),i=t.readUint8(),s=B(t.readBuffer(i));s=m(s,i);let a=t.readUint8(),r=1==(a>>>0&1),d=1==(a>>>1&1),h=1==(a>>>2&1),o=null,p=null;d&&r&&(o=t.readUint8()),h&&r&&(p=t.readUint8());let l=t.readUint8(),c=t.readUint8(),u=t.readUint8(),g=t.readUint8(),U=t.readUint8(),f=t.readUint8(),y=t.readUint8();n.push({index:e,desc:s,enable:r,napEnable:d,lightSleepEnable:h,hour:l,minute:c,napAlertTime:o,lightSleepAlertTime:p,repeatTime:u,vibrationType:g,vibrationTime:U,vibrationLevel1:f,vibrationLevel2:y})}return this.events=n,this}merger(e){return e.events.forEach((e=>{this.events.push(e)})),this}}class F{constructor(e,t){this.tag=168,this.sportHrSetting=e,this.generalHrSetting=t}getBytes(){let e=0,t=[];this.generalHrSetting&&(e|=1,t.push(this.generalHrSetting)),this.sportHrSetting&&(e|=2,t.push(this.sportHrSetting));let n=(new i).appendUint8(this.tag).appendUint32(e);return t.forEach((e=>{n.appendUint8(e.max).appendUint8(e.min).appendUint8((e.enable?1:0)<<0|(e.minEnable?1:0)<<1)})),n.build()}}class k{constructor(e=!0,t=8,i=0,n=18,s=0,a=60,r=127,d=0,h=5,o=9,p=9){this.tag=110,this.dataType="SedentaryReminder",this.enable=e,this.startHour=t,this.startMinute=i,this.endHour=n,this.endMinute=s,this.frequency=a,this.repeatTime=r,this.vibrationType=d,this.vibrationTime=h,this.vibrationLevel1=o,this.vibrationLevel2=p}getBytes(){let e=(new i).appendUint8(this.tag).appendUint8(1).appendUint8(this.enable);return this.enable&&e.appendUint8(1).appendUint8(0).appendUint8(this.enable).appendUint8(this.startHour).appendUint8(this.startMinute).appendUint8(this.endHour).appendUint8(this.endMinute).appendUint8(this.frequency).appendUint8(this.repeatTime).appendUint8(this.vibrationTime).appendUint8(this.vibrationLevel1).appendUint8(this.vibrationLevel2),e.build()}parserBuf(e){return new R(e).getUint8("enable").getUint8("startHour").getUint8("startMinute").getUint8("endHour").getUint8("endMinute").getUint8("frequency").getUint8("repeatTime").getUint8("vibrationTime").getUint8("vibrationLevel1").getUint8("vibrationLevel2").build(this),this}}class M{constructor(e=0){this.tag=121,this.timeFormat=e}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.timeFormat).build()}getCmd(){return 121}}class E{constructor(e){this.tag=169,this.workState=e}getBytes(){return(new i).appendUint8(this.tag).appendUint32(0).appendUint8(this.workState).build()}}class O{constructor(e){this.tag=248,this.dialIndex=e}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.dialIndex).build()}}class H{constructor(e){this.tag=250,this.pushStatus=e}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.pushStatus).build()}}class V{constructor(e,t){this.dataType="a5Step",this.cmd=t,new R(e,0).getUint24("step",!1).getUint32("utc",!1).getSFloat("examount").getFloat("calories",!1).getUint16("exerciseTime").getUint16("distance").getUint8("status").getUint8("batteryVoltage").build(this)}}class _{constructor(e,t,i){this.dataType="a5Daily",this.cmd=t;let n=new R(e);if(27===t){n.readUint8();let e=n.readUint8(),t=[];for(let i=0;i<e;i++){let e,i=n.readUint16(),s=n.readUint24(),a=n.readUint32(),r=n.readSfloat(),d=n.readFloat(),h=n.readUint16(),o=n.readUint16(),p=n.readUint8(),l=n.readUint8()/100+1.6,c=!1;1&i&&(c=!0,e=n.readUint8()),t.push({isSilenceExist:c,step:s,utc:a,examount:r,calories:d,exerciseTime:h,distance:o,status:p,batteryVoltage:l,silenceHeartRate:e})}this.type=0,this.list=t}else{let i=e.byteLength/19,s=[];for(let e=0;e<i;e++){let e=n.readUint24(),t=n.readUint32(),i=n.readSfloat(),a=n.readFloat(),r=n.readUint16(),d=n.readUint16(),h=n.readUint8(),o=n.readUint8()/100+1.6;s.push({isSilenceExist:!1,step:e,utc:t,examount:i,calories:a,exerciseTime:r,distance:d,status:h,batteryVoltage:o})}this.list=s,81===t?(this.type=0,this.list[s.length-1]):87===t&&(this.type=1)}}}const N="0000A500-0000-1000-8000-00805F9B34FB",P="0000A501-0000-1000-8000-00805F9B34FB",z="0000A502-0000-1000-8000-00805F9B34FB",q="0000A503-0000-1000-8000-00805F9B34FB",W="0000A700-0000-1000-8000-00805F9B34FB",Q="0000A701-0000-1000-8000-00805F9B34FB",Z="0000FCC0-0000-1000-8000-00805F9B34FB",j="0000FCC6-0000-1000-8000-00805F9B34FB",G="0000FCC7-0000-1000-8000-00805F9B34FB",Y="0000FCC8-0000-1000-8000-00805F9B34FB",J="0000180D-0000-1000-8000-00805F9B34FB",K="00002A37-0000-1000-8000-00805F9B34FB";class ${constructor(e,t){this.dataType="a5HR",this.cmd=t;let i=new R(e);if(83===t||137===t){i.getUint32("utc").getUint8("utcOffset").getUint16("reside");let e=i.readUint16();i.getUint8Array("heartRates",e).build(this),83==this.cmd?this.type=0:this.type=3,this.utcOffset*=5}else if(115===t){i.getUint32("utc").getUint8("utcOffset").getUint16("reside");let e=i.readUint16();i.getUint8Array("heartRates",e).build(this),this.sportMode=1,this.subMode=0,this.type=2,this.utcOffset*=5}else if(229===t){i.getUint8("sportMode").getUint8("subMode").getUint32("utc").getUint8("utcOffset").getUint16("reside");let e=i.readUint16();i.getUint8Array("heartRates",e).build(this),this.type=2,this.utcOffset*=5}else if(16===t){let t=new R(e).getUint8("type").getUint32("utc").getUint8("utcOffset").getUint16("reside"),i=t.readUint16();t.getUint8Array("heartRates",i).build(this),this.utcOffset*=5,0===this.type?this.type=0:1===this.type||5===this.type?this.type=2:this.type=3}else if(t===K){this.cmd=10807;let t=new R(e),i=t.readUint8(),n=i>>1&1|i>>2&1,s=0;0===(1&i)?s=t.readUint8():e.byteLength>=3&&(s=t.readUint16()),this.status=n,this.heartRates=[s],this.type=1}this.heartRates||(this.heartRates=[])}merger(e){return e.heartRates.forEach((e=>{this.heartRates.push(e)})),this}}class X{constructor(e,t){this.dataType="a5Sleep",this.cmd=t;let i=new R(e);this.utc=i.readUint32(),this.utcOffset=5*i.readUint8(),this.reside=i.readUint16(),i.readInt16();let n=e.byteLength-9,s=[];for(;n>0;){let e=i.readUint8(),t=127&e;n-=1;let a=1;for(0!=(128&e)&&n>0&&(a=i.readUint8(),n-=1);a>0;)s.push(t),a-=1}this.levelSet=s}}class ee{constructor(e,t,i){this.dataType="a5SportCalories",this.cmd=t;let n=new R(e),s=function(e){return!!(e.model&&e.model.indexOf("460")>=0)&&(console.log("isWatch"),!0)}(i);if(127==this.cmd){let t=e.byteLength-9;n.getUint32("utc").getUint8("utcOffset").getUint16("reside").getUint16("_count").getUint16Array("calories",t).build(this),this.sportMode=1,this.subMode=0,this.isNew=!1}else{if(s)n.getUint8("sportMode").getUint8("subMode").getUint32("utc").getUint8("utcOffset").getUint16("reside"),this._count=n.readUint16(),n.getUint16Array("calories",2*this._count).build(this);else{let t=e.byteLength-11;n.getUint8("sportMode").getUint8("subMode").getUint32("utc").getUint8("utcOffset").getUint16("reside").getUint16("_count").getUint16Array("calories",t).build(this)}this.isNew=!0}let a=[];for(let e=0;e<this.calories.length;e++){let t=this.calories[e];s?a.push(t/1e3):a.push(t/10)}this.calories=a,this.utcOffset*=5}merger(e){return e.calories.forEach((e=>{this.calories.push(e)})),this}}class te{constructor(e,t){this.dataType="a5SportPace",this.cmd=t;let i=new R(e);i.getUint8("sportMode").getUint8("subMode").getUint32("utc").getUint8("utcOffset").getUint16("reside");let n=i.readUint16();i.getUint16Array("speeds",2*n).build(this),this.utcOffset*=5}merger(e){return e.speeds.forEach((e=>{this.speeds.push(e)})),this}}class ie{constructor(e,t){this.pauseUtc=e,this.reStartUtc=t}}class ne{constructor(e,t){this.dataType="a5SportReport",this.cmd=t;let i=new R(e);if(114==this.cmd)return void this.parseRunStateData(i);if(20===this.cmd)return i.getUint8("sportMode").getUint8("subMode").getUint32("start").getUint32("end").getUint16("sportTime").getUint32("step").getUint32("distance").getUint16("calories").getUint8("avgHr").getUint8("maxHr").getUint16("avgStepFreq").getUint8("avgStepOfFloating").getUint16("avgPace").getUint16("hrSection1TimeRatio").getUint16("hrSection2TimeRatio").getUint16("hrSection3TimeRatio").getUint16("hrSection4TimeRatio").getUint16("hrSection5TimeRatio").build(this),this.hrSection1TimeRatio*=.1,this.hrSection2TimeRatio*=.1,this.hrSection3TimeRatio*=.1,this.hrSection4TimeRatio*=.1,this.hrSection5TimeRatio*=.1,void(this.calories*=.1);let n=i.readUint8();switch(this.sportMode=n,this.subMode=i.readUint8(),n){case 1:this.parseRunData(i);break;case 3:case 24:this.parseCyclingData(i);break;case 4:this.parseSwimmingData(i);break;case 11:this.parseFootBallData(i);break;default:this.parseNormalData(i)}}parseRunStateData(e){this.sportMode=1,this.subMode=1,this.suspendTimes=e.readUint8(),e.getUint32("start");let t=[];for(let i=0;i<this.suspendTimes-1;i++){let i=e.readInt32(),n=e.readInt32();t.push(new ie(i,n))}this.states=t,e.getUint32("end").getUint16("sportTime").getUint24("step").getUint32("calories").getUint8("maxHr").getUint8("avgHr").getUint8("maxStepFreq").getUint8("avgStepFreq").build(this)}parseRunData(e){this.flag=e.readUint32(),this.suspendTimes=e.readUint8(),e.getUint32("start");let t=[];for(let i=0;i<this.suspendTimes-1;i++){let i=e.readInt32(),n=e.readInt32();t.push(new ie(i,n))}this.states=t,e.getUint32("end").getUint16("sportTime").getUint24("step").getFloat("calories").getUint8("maxHr").getUint8("avgHr").getUint8("maxStepFreq").getUint8("avgStepFreq").build(this)}parseCyclingData(e){this.flag=e.readUint16(),this.flag;let t=1==(this.flag>>1&1),i=1==(this.flag>>5&1);this.suspendTimes=e.readUint8(),e.getUint32("start");let n=[];for(let t=0;t<this.suspendTimes-1;t++){let t=e.readInt32(),i=e.readInt32();n.push(new ie(t,i))}if(this.states=n,e.getUint32("end").getUint16("sportTime").getUint32("calories").getUint8("maxHr").getUint8("avgHr").getUint16("maxSpeed").getUint16("avgSpeed").getUint32("distance"),t&&e.getUint8("infoOfTarget").getUint16("targetType").getUint32("targetValue"),i)try{e.getUint8("hrSectionFlag").getUint16("hrSection1TimeRatio").getUint16("hrSection2TimeRatio").getUint16("hrSection3TimeRatio").getUint16("hrSection4TimeRatio").getUint16("hrSection5TimeRatio")}catch(e){}e.build(this),this.calories=this.calories/10,this.maxSpeed=this.maxSpeed/100,this.avgSpeed=this.avgSpeed/100}parseSwimmingData(e){this.flag=e.readUint32();let t=1==(1&this.flag),i=1==(this.flag>>1&1),n=1==(this.flag>>2&1),s=1==(this.flag>>3&1),a=1==(this.flag>>4&1),r=1==(this.flag>>5&1);if(e.getUint32("flag").getUint32("start").getUint32("end").getUint16("sportTime").getUint16("step").getUint32("calories"),t&&e.getUint32("distance"),i&&e.getUint8("mainStrokes"),n&&e.getUint32("avgSwolf"),s&&e.getUint32("numberOfStroke"),a&&e.getUint8("infoOfTarget").getUint16("targetType").getUint32("targetValue"),r)try{e.getUint8("hrSectionFlag").getUint16("hrSection1TimeRatio").getUint16("hrSection2TimeRatio").getUint16("hrSection3TimeRatio").getUint16("hrSection4TimeRatio").getUint16("hrSection5TimeRatio")}catch(e){}e.build(this),this.calories=this.calories/10}parseNormalData(e){this.flag=e.readUint16();let t=1==(1&this.flag),i=1==(this.flag>>1&1),n=1==(this.flag>>5&1);this.suspendTimes=Math.max(1,e.readUint8()),e.getUint32("start");let s=[];for(let t=0;t<this.suspendTimes-1;t++){let t=e.readInt32(),i=e.readInt32();s.push(new ie(t,i))}if(this.states=s,e.getUint32("end").getUint16("sportTime").getUint24("step").getUint32("calories").getUint8("maxHr").getUint8("avgHr").getUint16("maxSpeed").getUint16("avgSpeed").getUint32("distance"),t&&e.getUint8("maxStepFreq").getUint8("avgStepFreq"),i&&e.getUint8("infoOfTarget").getUint16("targetType").getUint32("targetValue"),n)try{e.getUint8("hrSectionFlag").getUint16("hrSection1TimeRatio").getUint16("hrSection2TimeRatio").getUint16("hrSection3TimeRatio").getUint16("hrSection4TimeRatio").getUint16("hrSection5TimeRatio")}catch(e){}e.build(this),this.step=(16711680&this.step)>>>16==255?0:this.step;let a=(4294901760&this.calories)>>>16==65535?0:this.calories;this.calories=a/10;let r=32768&this.maxSpeed?0:this.maxSpeed;this.maxSpeed=r/100;let d=32768&this.avgSpeed?0:this.avgSpeed;this.avgSpeed=d/100,this.distance=(4294901760&this.distance)>>>16==65535?0:this.distance}parseFootBallData(e){this.flag=e.readUint16();let t=1==(1&this.flag),i=1==(this.flag>>1&1),n=1==(this.flag>>2&1),s=1==(this.flag>>3&1),a=1==(this.flag>>5&1);this.suspendTimes=Math.max(1,e.readUint8()),e.getUint32("start");let r=[];for(let t=0;t<this.suspendTimes-1;t++){let t=e.readInt32(),i=e.readInt32();r.push(new ie(t,i))}if(this.states=r,e.getUint32("end").getUint16("sportTime").getUint24("step").getUint32("calories").getUint8("maxHr").getUint8("avgHr").getUint16("maxSpeed").getUint16("avgSpeed").getUint32("distance"),t&&e.getUint8("maxStepFreq").getUint8("avgStepFreq"),i&&e.getUint8("maxHrWhenMaxStepFreq"),n&&e.getUint8("infoOfTarget").getUint16("targetType").getUint32("targetValue"),s&&e.getUint16("sprintSpeed"),a)try{e.getUint8("hrSectionFlag").getUint16("hrSection1TimeRatio").getUint16("hrSection2TimeRatio").getUint16("hrSection3TimeRatio").getUint16("hrSection4TimeRatio").getUint16("hrSection5TimeRatio")}catch(e){}e.build(this),this.step=(16711680&this.step)>>>16==255?0:this.step;let d=(4294901760&this.calories)>>>16==65535?0:this.calories;this.calories=d/10;let h=32768&this.maxSpeed?0:this.maxSpeed;this.maxSpeed=h/100;let o=32768&this.avgSpeed?0:this.avgSpeed;this.avgSpeed=o/100,this.distance=(4294901760&this.distance)>>>16==65535?0:this.distance,s&&(this.sprintSpeed=this.sprintSpeed/100)}}class se{constructor(e,t){this.dataType="a5SportStatus",this.cmd=t,new R(e).getUint8("function").getUint8("sportStatus").getUint8("sportMode").build(this)}}const ae=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];function re(e,t=0){let i=0,n=4294967295&t;if(null==e)return n;let s=new Uint8Array(e);for(i=0;i<e.byteLength;i++){let e=255&(n^s[i]);n=ae[e]^n>>>8}return(4294967295&n)>>>0}function de(e){if(!e||0===e.byteLength)return"";let t=new DataView(e),i="";for(let e=0;e<t.byteLength;e++)i+=t.getUint8(e).toString(16).padStart(2,"0").toUpperCase();return i}function he(...e){if(!e)return new ArrayBuffer(0);let t=0;for(let i=0;i<e.length;i++)t+=e[i].byteLength;let i=new ArrayBuffer(t),n=new DataView(i),s=0;for(let i=0;i<e.length;i++){let a=e[i],r=new DataView(a);for(let e=0;e<a.byteLength&&s<t;e++)n.setUint8(s,r.getUint8(e)),s+=1}return i}class oe{constructor(e,t){this.dataType="DeviceInfo",this.cmd=t;let i=new R(e),n=i.readBuffer(6);this.mac=de(n),i.getString("model",5).getString("softVersion",4).getString("hardwareVersion",4).getUint8("timezone"),this.hrSwitch=i.readUint8(),2==this.hrSwitch?i.getUint32("dataSize"):i.getUint8("startHour").getUint8("startMinute").getUint8("endHour").getUint8("endMinute"),i.build(this)}}class pe{constructor(e){this.tag=184,this.events=e}getBytes(){let e=(new i).appendUint8(this.tag).appendUint8(this.events.length);return this.events.forEach((t=>{e.appendUint8(t.index).appendUint8(t.type);let i=w(m(t.desc,24));e.appendUint8(i.byteLength).appendBuffer(i).appendUint8(t.enable).appendUint8(t.hour).appendUint8(t.minute).appendUint8(t.repeatTime).appendUint8(t.vibrationType).appendUint8(t.vibrationTime).appendUint8(t.vibrationLevel1).appendUint8(t.vibrationLevel2)})),e.build()}}class le{constructor(){this.QLZ_STREAMING_BUFFER=0,this.QLZ_MEMORY_SAFE=0,this.QLZ_VERSION_MAJOR=1,this.QLZ_VERSION_MINOR=5,this.QLZ_VERSION_REVISION=0,this.HASH_VALUES=4096,this.MINOFFSET=2,this.UNCONDITIONAL_MATCHLEN=6,this.UNCOMPRESSED_END=4,this.CWORD_LEN=4,this.DEFAULT_HEADERLEN=9,this.QLZ_POINTERS_1=1,this.QLZ_POINTERS_3=16}headerLen(e){return 2==(2&e[0])?9:3}sizeDecompressed(e){return 9==this.headerLen(e)?this.fast_read(e,5,4):this.fast_read(e,2,1)}sizeCompressed(e){return 9==this.headerLen(e)?this.fast_read(e,1,4):this.fast_read(e,1,1)}write_header(e,t,i,n,s){e[0]=2|(i?1:0),e[0]|=t<<2,e[0]|=64,e[0]|=0,this.fast_write(e,1,s,4),this.fast_write(e,5,n,4)}fast_write(e,t,i,n){for(let s=0;s<n;s++)e[t+s]=i>>8*s}arraycopy(e,t=0,i,n=0,s=e.length){new Uint8Array(i,n).set(new Uint8Array(e,t,s))}fast_read(e,t,i){var n=0;for(let s=0;s<i;s++)n|=(255&e[t+s])<<8*s;return n}compress(e,t){let i,n=0,s=this.DEFAULT_HEADERLEN+this.CWORD_LEN>>>0,a=2147483648,r=this.DEFAULT_HEADERLEN>>>0,d=new Uint8Array(e.length+400);new Uint32Array(this.HASH_VALUES);let h,o,p=new Uint8Array(this.HASH_VALUES),l=0,c=e.length-this.UNCONDITIONAL_MATCHLEN-this.UNCOMPRESSED_END-1;if(3!=t)throw new RuntimeException("Java version only supports level 1 and 3");if(1==t?(o=this.QLZ_POINTERS_1,i=new Uint32Array(o*this.HASH_VALUES)):(o=this.QLZ_POINTERS_3,i=new Uint32Array(o*this.HASH_VALUES)),0==e.length)return new ArrayBuffer(0);for(n<=c&&(l=e[n]|e[n+1]<<8|e[n+2]<<16);n<=c;){if(1==(1&a)){if(n>e.length>>1&&s>n-(n>>5)){h=new Uint8Array(e.length+this.DEFAULT_HEADERLEN),this.write_header(h,t,!1,e.length,e.length+this.DEFAULT_HEADERLEN);for(let t=0;t<e.length;t++)h[t+this.DEFAULT_HEADERLEN]=e[t];return h.buffer}this.fast_write(d,r,a>>>1|2147483648,4),r=s,s+=this.CWORD_LEN,a=2147483648}let o,c;l=e[n]|e[n+1]<<8|e[n+2]<<16;let u,g=0,U=0,f=0,m=e.length-this.UNCOMPRESSED_END-n+1-1>255?255:e.length-this.UNCOMPRESSED_END-n+1-1,y=(l>>12^l)&this.HASH_VALUES-1;for(u=p[y],g=0,c=0,U=0;U<this.QLZ_POINTERS_3&&u>U;U++)if(o=i[y+U*this.HASH_VALUES],(255&l)==e[o]&&(l>>>8&255)==e[o+1]&&(l>>>16&255)==e[o+2]&&o<n-this.MINOFFSET){for(f=3;e[o+f]==e[n+f]&&f<m;)f++;(f>g||f==g&&o>c)&&(c=o,g=f)}if(o=c,i[y+(u&this.QLZ_POINTERS_3-1)*this.DEFAULT_HEADERLEN]=n,u++,p[y]=u,g>=3&&n-o<131071){let t=n-o;for(let t=1;t<g;t++)l=e[n+t]|e[n+t+1]<<8|e[n+t+2]<<16,y=(l>>>12^l)&this.HASH_VALUES-1,u=p[y]++,i[y+(u&this.QLZ_POINTERS_3-1)*this.DEFAULT_HEADERLEN]=n+t;n+=g,a=a>>>1|2147483648,3==g&&t<=63?(this.fast_write(d,s,t<<2,1),s++):3==g&&t<=16383?(this.fast_write(d,s,t<<2|1,2),s+=2):g<=18&&t<=1023?(this.fast_write(d,s,g-3<<2|t<<6|2,2),s+=2):g<=33?(this.fast_write(d,s,g-2<<2|t<<7|3,3),s+=3):(this.fast_write(d,s,g-3<<7|t<<15|3,4),s+=4)}else d[s]=e[n],a>>>=1,n++,s++}for(;n<=e.length-1;)1==(1&a)&&(this.fast_write(d,r,a>>>1|2147483648,4),r=s,s+=this.CWORD_LEN,a=2147483648),d[s]=e[n],n++,s++,a>>>=1;for(;1!=(1&a);)a>>>=1;return this.fast_write(d,r,a>>>1|2147483648,this.CWORD_LEN),this.write_header(d,t,!0,e.length,s),d.buffer.slice(0,s)}}function ce(e,t="",n){let s=w(t).slice(0,24),a=(new i).appendUint32(69).appendUint32(e.byteLength).appendBuffer(s,24).build(),r=re(e),d=w("V001"),h=(new i).appendUint8(5).appendUint16(30,!0).appendBuffer(d,4).appendUint8(49).appendUint8(48).appendUint32(2147483647,!0).appendUint32(69,!0).appendUint32(e.byteLength,!0).appendUint32(r,!0).appendUint32(1,!0).appendUint32(32,!0).build(),o=re(h)>>>0,p=(new i).appendUint32(o,!0).appendBuffer(h).appendBuffer(a).appendBuffer(e).appendBuffer(h).build(),l=p.byteLength,c=re(p),u=(new i).appendUint8(3).appendUint16(33,!0).appendUint8(1).appendUint8(0).appendUint8(49).appendUint32(2147483647,!0).appendUint16(0,!0).appendUint32(103,!0).appendUint32(l,!0).appendUint32(c,!0).appendUint32(l,!0).appendUint32(c,!0).appendUint32(7,!0).build(),g=(new i).appendUint8(34).appendUint16(h.byteLength+u.byteLength,!0).appendBuffer(h).appendBuffer(u).build(),U=w(n.model),f=w("H10"),m=(new i).appendUint8(1).appendUint16(21,!0).appendUint8(1).appendBuffer(U,5).appendBuffer(f,3).appendUint32(103,!0).appendUint32(l,!0).appendUint32(c,!0).build(),y=(new i).appendBuffer(m).appendBuffer(g).build(),b=re(y),v=(new i).appendUint8(32).appendUint16(y.byteLength,!0).appendBuffer(y).build();return b=re(v.slice(0,99)),he((new i).appendUint32(b,!0).appendBuffer(v).build(),p)}function ue(e){if(!e)return;let i=new le,n=new Int8Array(e);try{return i.compress(n,3)}catch(i){t.Logger.error("压缩失败",e.byteLength,i)}}function ge(e,t,n){let s=4*t,a=new i;a.appendUint32(4+(t<<10)+(n<<21),!0);for(let i=0;i<n;i++)for(let n=0;n<t;n++){let t=s*i+4*n,r=e[t],d=e[t+1],h=e[t+2];r=Ue(r,5),d=Ue(d,6),h=Ue(h,5),r>248&&(r=248),d>252&&(d=252),h>248&&(h=248);let o=r<<8|d<<3|h>>>3;a.appendUint16(o)}return a.build()}function Ue(e,t){let i=1<<8-t,n=e/i,s=Math.floor(n);return 10*n%10>5&&(s+=1),s*i}class fe{constructor(e,t,i){this.dataType="LoginReq",this.tag=t;let n=new R(e);this.protoVersion=i;try{this.md5=n.readBuffer(16),17==e.byteLength&&(this.bindState=n.readUint8())}catch(e){}}}class me{constructor(e,t,i,n){this.tag=0,this.result=e,this.utc=t,this.timezone=i,this.platform=n}getBytes(){return(new i).appendUint8(this.result?1:0).appendUint32(this.utc).appendUint8(this.timezone).appendUint8(this.platform).build()}}class ye{constructor(e=5){this.tag=0,this.state=e}getBytes(){return(new i).appendUint8(this.state).build()}}class be{constructor(e,t,i){this.tag=192,this.cmd=192,this.dataType="ControlMusicAndDevice",this.workMode=e,this.switchType=t,this.vol=i}getBytes(){let e=0;return e=0===this.workMode?this.workMode:128+(127&this.vol),(new i).appendUint8(this.tag).appendUint8(e).build()}parserBuf(e){let t=new Uint8Array(e)[0];return t>>7==1?(this.vol=127&t,this.workMode=1):(this.workMode=0,this.switchType=t),this}}class we{constructor(e,t,i,n,s,a,r=0){this.tag=227,this.localRate=0,this.result=e,this.utc=t,this.timezone=i,this.platform=n,this.weight=s,this.height=a,this.localRate=r}getBytes(){let e=(new i).appendUint8(this.tag).appendUint8(this.result).appendUint32(this.utc).appendUint8(this.timezone).appendUint8(this.platform),t=L(this.weight),n=L(this.height);return e.appendUint32(t),e.appendUint32(n),e.appendUint8(this.localRate),e.build()}}class ve{constructor(e=255){this.tag=240,this.syncDataType=e}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.syncDataType).appendUint32(0).build()}}var Se=Object.freeze({__proto__:null,RandomNumRequest:class{constructor(e){this.tag=123,this.randomNum=e}getBytes(){let e=(new i).appendUint8(123).appendUint8(0);for(let t=0;t<6;t++)e.appendUint8(this.randomNum.charCodeAt(t));return e.build()}},AlarmClockSetting:class{constructor(e=!0,t=[]){this.tag=105,this.enable=e,this.alarmClocks=t}getBytes(){let e=this.alarmClocks,t=(new i).appendUint8(this.tag).appendUint8(1).appendUint8(this.enable).appendUint8(e.length);for(let i=0;i<e.length;i++){let n=e[i];t.appendUint8(n.index).appendUint8(n.enable).appendUint8(n.hour).appendUint8(n.minute).appendUint8(n.repeatTime).appendUint8(n.vibrationType).appendUint8(n.vibrationTime).appendUint8(n.vibrationLevel1).appendUint8(n.vibrationLevel2)}return t.build()}},AntiLostSetting:class{constructor(e=!0){this.tag=111,this.enable=e}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.enable).build()}},AutoRecognitionSportSetting:class{constructor(e=[]){this.tag=162,this.configs=e}getBytes(){let e=(new i).appendUint8(this.tag),t=this.configs;e.appendUint8(t.length);for(let i=0;i<t.length;i++){let n=t[i];e.appendUint8(n.sportMode),e.appendUint8(n.enable)}return e.build()}},CustomPagesSetting:p,DialTypeSetting:class{constructor(e=1){this.tag=161,this.dialType=e}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.dialType).build()}},EncourageTargetSetting:class{constructor(e=!0,t=1,i=6e3){this.tag=165,this.enable=e,this.targetType=t,this.value=i}getBytes(e){if(c(e)){let e=16;switch(this.targetType){case 1:e=16;break;case 5:e=45;break;case 6:e=54;break;default:t.Logger.warn("不支持的类型",this.targetType)}return new C([{tag:e,value:this.value}]).getBytes()}let n=(new i).appendUint8(this.tag).appendUint8(this.enable).appendUint8(this.targetType);if(2===this.targetType)n.appendUint32(10*this.value);else n.appendUint32(this.value);return n.build()}},EventReminderSetting:A,HeartRateDetectSetting:class{constructor(e){this.tag=118,this.state=e}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.state).build()}},HeartRateSectionSetting:F,LanguageSetting:class{constructor(e="zh-CN"){this.tag=170,this.lang=e}getBytes(){let e=(new i).appendUint8(this.tag),t=new Int8Array(y(this.lang)).buffer;return e.appendBuffer(t).appendUint32(0),e.build()}},MessageReminderSetting:class{constructor(e=!0,t=1,i){this.tag=106,this.enable=e,this.reminderType=t}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.reminderType).appendUint8(this.enable).appendUint8(0).appendUint8(0).appendUint8(60).appendUint8(9).appendUint8(9).build()}},NightModeSetting:class{constructor(e=!0,t=23,i=0,n=7,s=0){this.tag=119,this.enable=e,this.startHour=t,this.startMinute=i,this.endHour=n,this.endMinute=s}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.enable).appendUint8(this.startHour).appendUint8(this.startMinute).appendUint8(this.endHour).appendUint8(this.endMinute).build()}},NoDisturbSetting:class{constructor(e=!0,t=23,i=0,n=6,s,a=!0){this.tag=179,this.enable=e,this.startHour=t,this.startMinute=i,this.endHour=n,this.endMinute=s,this.isEnableRaise=a}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.enable).appendUint8(this.startHour).appendUint8(this.startMinute).appendUint8(this.endHour).appendUint8(this.endMinute).appendUint32(this.isEnableRaise,!1).appendUint32(0).build()}},PaceAndDistanceSetting:class{constructor(e,t){this.tag=171,this.pace=e,this.distance=t}getBytes(){return(new i).appendUint8(this.tag).appendUint16(0).appendUint16(this.pace).appendUint32(this.distance).build()}},ScreenDirectionSetting:class{constructor(e=1){this.tag=125,this.orientation=e}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.orientation).build()}},SedentaryReminderSetting:k,SportControlSetting:class{constructor(e,t){this.tag=175,this.sportMode=e,this.start=t}getBytes(){return(new i).appendUint8(this.tag).appendUint32(0).appendUint8(this.sportMode).appendUint8(!this.start).appendUint16(0).appendUint8(0).build()}getCmd(){return 175}},SportHeartRateReminderSetting:class{constructor(e,t,i){this.tag=168,this.enable=e,this.maxHr=t,this.minHr=i}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.maxHr).appendUint8(this.minHr).appendUint8(this.enable).build()}getCmd(){return 168}},SwimmingParamsSetting:class{constructor(e=25){this.tag=172,this.length=e}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.length).build()}getCmd(){return 172}},TimeFormatSetting:M,WearingHabitsSetting:class{constructor(e=0){this.tag=122,this.wearingHabits=e}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.wearingHabits).build()}getCmd(){return 122}},WeatherSetting:class{constructor(e,t=[]){this.tag=166,this.updateTime=e,this.weathers=t}getBytes(){let e=(new i).appendUint8(this.tag).appendUint32(this.updateTime).appendUint8(this.weathers.length);for(let t=0;t<this.weathers.length;t++){let i=this.weathers[t];e.appendUint8(i.weatherCode).appendUint8(i.minTemperature).appendUint8(i.maxTemperature).appendUint16(i.aqi,!1)}return e.build()}getCmd(){return 166}},GpsStatusSetting:class{constructor(e){this.tag=167,this.enable=e}getBytes(){return(new i).appendUint8(this.tag).appendUint8(1).appendUint8(this.enable).appendUint32(0).appendUint16(0).appendUint8(0).build()}},SportStatusSetting:class{constructor(e,t=1){this.tag=225,this.gpsStatus=e,this.mode=t}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.mode).appendUint8(this.gpsStatus).appendUint32(0).appendUint16(0).appendUint8(0).build()}getCmd(){return 225}},RandomNumSetting:class{constructor(e){this.tag=123,this.randomNum=e}getBytes(){let e=(new i).appendUint8(this.tag).appendUint8(0);for(let t=0;t<6;t++)e.appendUint8(this.randomNum.charCodeAt(t));return e.build()}},OldMsgReminderSetting:class{constructor(e=!0,t=1,i){this.tag=161,this.enable=e,this.reminderType=t,this.appId=i}getBytes(){let e=(new i).appendUint8(this.tag).appendUint8(this.enable).appendUint8(this.reminderType),t=this.appId;if(t){e.appendUint8(t.length);let i=new Int8Array(y(t)).buffer;e.appendBuffer(i)}return e.build()}},RealtimeHRSetting:class{constructor(e){this.tag=65348,this.enable=e}getBytes(){return(new i).build()}},ControlDeviceSetting:E,HeartRateWarningSetting:F,MultipleSetting:C,NewEventRemindSetting:pe,PushDialSetting:class{constructor(e,t="",i=2,n="",s="",a=0,r=0,d=new ArrayBuffer(0),h,o){this.tag=249,this.dialIndex=e,this.id=t,this.dailType=i,this.fileName=n,this.backgroundImageName=s,this.styleId=a,this.colorId=r,this.fileBuf=d,this.onUpgradeProcess=h,this.onUpgradeComplete=o}getBytes(){let e=(new i).appendUint8(this.tag).appendUint8(this.dialIndex),t=w(m(this.id,32));e.appendUint8(t.byteLength).appendBuffer(t).appendUint8(this.dailType);let n=w(m(this.fileName,32));e.appendUint8(n.byteLength).appendBuffer(n);let s=w(m(this.backgroundImageName,32));return e.appendUint8(s.byteLength).appendBuffer(s).appendUint8(this.styleId).appendUint8(this.colorId),e.build()}},DialEnableSetting:class{constructor(e,t){this.tag=247,this.dailNoList=t,this.dailIndex=e}getBytes(e){let t=(new i).appendUint8(this.tag);return t.appendUint8(this.dailIndex),t.appendUint8(this.dailNoList.length),this.dailNoList.forEach((e=>{t.appendUint8(e)})),t.build()}},packingWatchFaceFile:function(e,i=120,n=240,s,a=90,r=180,d){return ce(he(ge(e,i,n),ge(s,a,r)),"WatchFace-Custom",t.getDeviceInfo(d))},compress:function(e,t="",n){let s=w(t).slice(0,24),a=(new i).appendUint32(69).appendUint32(e.byteLength).appendBuffer(s,24).build(),r=re(e),d=w("V001"),h=(new i).appendUint8(5).appendUint16(30,!0).appendBuffer(d,4).appendUint8(49).appendUint8(48).appendUint32(2147483647,!0).appendUint32(69,!0).appendUint32(e.byteLength,!0).appendUint32(r,!0).appendUint32(1,!0).appendUint32(32,!0).build(),o=re(h)>>>0,p=(new i).appendUint32(o,!0).appendBuffer(h).appendBuffer(a).appendBuffer(e).appendBuffer(h).build(),l=e.byteLength,c=0,u=new i;do{let e=ue(p.slice(c,c+2048));e&&e.byteLength>0&&u.appendBuffer(e),c+=2048}while(c<l);let g=u.build(),U=re(g),f=re(e)>>>0,m=(new i).appendUint8(3).appendUint16(33,!0).appendUint8(1).appendUint8(32).appendUint8(49).appendUint32(2147483647,!0).appendUint16(8,!0).appendUint32(103,!0).appendUint32(g.byteLength,!0).appendUint32(U,!0).appendUint32(e.byteLength,!0).appendUint32(f,!0).appendUint32(7,!0).build(),y=(new i).appendUint8(34).appendUint16(h.byteLength+m.byteLength,!0).appendBuffer(h).appendBuffer(m).build(),b=w(n.model),v=w("H10"),S=(new i).appendUint8(1).appendUint16(21,!0).appendUint8(1).appendBuffer(b,5).appendBuffer(v,3).appendUint32(103,!0).appendUint32(g.byteLength,!0).appendUint32(U,!0).build(),T=(new i).appendBuffer(S).appendBuffer(y).build(),I=re(T),B=(new i).appendUint8(32).appendUint16(T.byteLength,!0).appendBuffer(T).build();return I=re(B.slice(0,99)),he((new i).appendUint32(I,!0).appendBuffer(B).build(),g)},unCompress:ce,LoginBindResp:ye,SportHeartRateSectionSetting:class{constructor(e=20,t,i,n,s,a){this.tag=116,this.age=e,this.level0=t,this.level1=i,this.level2=n,this.level3=s,this.level4=a}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.age).appendUint8(this.level0).appendUint8(this.level1).appendUint8(this.level2).appendUint8(this.level3).appendUint8(this.level4).appendUint8(0).build()}},HeartRateWarningCycleSetting:class{constructor(e=!0,t=0){this.tag=246,this.heartRateWaringCycle=t,this.enable=e}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.enable).appendUint8(this.heartRateWaringCycle).build()}},BindResp:we,ReminderSetting:class{constructor(e=[],t=4,i=!0){this.tag=254,this.dataType="reminder",this.reminderType=t,this.enable=i,this.list=e}getBytes(e){if(u(e)){let e=(new i).appendUint8(this.tag).appendUint8(this.reminderType).appendUint8(this.enable);return this.enable&&(this.list&&this.list.length>0?(e.appendUint8(this.list.length),this.list.forEach((t=>{e.appendUint8(t.index).appendUint8(t.enable).appendUint8(t.startHour).appendUint8(t.startMinute).appendUint8(t.endHour).appendUint8(t.endMinute).appendUint8(t.reminderMode),0===t.reminderMode?(e.appendUint8(t.reminderHour),e.appendUint8(t.reminderMinute)):e.appendUint16(t.frequency),e.appendUint8(t.repeatTime).appendUint8(t.vibrationTime).appendUint8(t.vibrationType).appendUint8(t.vibrationLevel1).appendUint8(t.vibrationLevel2).appendUint8(t.noDisturbEnable).appendUint8(t.noDisturbStartHour).appendUint8(t.noDisturbStartMinute).appendUint8(t.noDisturbEndHour).appendUint8(t.noDisturbEndMinute)}))):e.appendInt8(0)),e.build()}try{let e=this.list[0];return new k(e.enable,e.startHour,e.startMinute,e.endHour,e.endMinute,e.frequency,e.repeatTime,e.vibrationType,e.vibrationTime,e.vibrationLevel1,e.vibrationLevel2).getBytes()}catch(e){return}}parserBuf(e){let t=new R(e);this.reminderType=t.readUint8(),this.enable=t.readUint8()>0;let i=t.readUint8(),n=[];for(let e=0;e<i;e++){let e=t.readUint8(),i=t.readUint8(),s=t.readUint8(),a=t.readUint8(),r=t.readUint8(),d=t.readUint8(),h=t.readUint8(),o={};if(0===h){o={frequency:t.readUint16()}}else{o={reminderHour:t.readUint8(),reminderMinute:t.readUint8()}}let p=t.readUint8(),l=t.readUint8(),c=t.readUint8(),u=t.readUint8(),g=t.readUint8(),U=t.readUint8(),f=t.readUint8(),m=t.readUint8(),y=t.readUint8(),b=t.readUint8();n.push(Object.assign(Object.assign({index:e,enable:i,startHour:s,startMinute:a,endHour:r,endMinute:d,reminderMode:h},o),{repeatTime:p,vibrationType:l,vibrationTime:c,vibrationLevel1:u,vibrationLevel2:g,noDisturbEnable:U,noDisturbStartHour:f,noDisturbStartMinute:m,noDisturbEndHour:y,noDisturbEndMinute:b}))}return this.list=n,this}},MsgNotifySetting:class{constructor(e,t,i,n=0){this.serviceId=Z,this.tag=4,this.msgType1=4,this.msgInfo=e,this.count=t,this.appType=i,this.msgType2=n}getBytes(){let e=(new i).appendUint8(this.msgType1).appendUint8(this.msgType2).appendUint16(this.appType).appendUint8(this.count);e.appendUint32(this.msgInfo.msgId);let t=w(this.msgInfo.title);return e.appendUint16(t.byteLength),e.appendBuffer(t),e.build()}},CallNotifySetting:class{constructor(e,t=0){this.tag=1,this.serviceId=Z,this.msgType1=1,this.msgType2=t,this.content=e}getBytes(){let e=w(this.content);return(new i).appendUint8(this.msgType1).appendUint8(this.msgType2).appendBuffer(e).build()}},NewWeatherSetting:class{constructor(e,t=[],i=""){this.tag=49,this.utc=e,this.weathers=t,this.cityName=i}getBytes(){let e=(new i).appendUint8(this.tag).appendUint32(this.utc).appendUint8(this.weathers.length);for(let t=0;t<this.weathers.length;t++){let i=this.weathers[t];e.appendUint8(i.weatherCode).appendInt8(i.currentTemperature||0).appendUint8(i.maxTemperature||0).appendInt8(i.minTemperature||0).appendUint8(i.windSpeed).appendUint8(i.humidity).appendUint8(i.uvIndex).appendUint16(i.aqi).appendUint8(i.sunriseHour).appendUint8(i.sunriseMinute).appendUint8(i.sunsetHour).appendUint8(i.sunsetMinute)}let t=w(this.cityName);return e.appendUint8(1).appendUint8(t.byteLength).appendBuffer(t),e.build()}getCmd(){return 166}},ControlMusicAndDeviceSettting:be,MusicInfoSetting:class{constructor(e){this.tag=242,this.info=e}getBytes(){let e=m(this.info.musicName,90),t=m(this.info.author||"N",90),n=m(this.info.album||"N",90),s=w(e),a=w(n),r=w(t);return(new i).appendUint8(this.tag).appendUint8(this.info.playStatus||0).appendUint8(this.info.volLevel||0).appendUint16(this.info.playTime||0).appendUint16(this.info.duration||0).appendUint8(this.info.collectionFlag||0).appendUint8(s.byteLength).appendBuffer(s).appendUint8(r.byteLength).appendBuffer(r).appendUint8(a.byteLength).appendBuffer(a).appendUint8(0).appendUint8(this.info.maxVol||0).appendUint16(0).build()}},SyncReqSetting:ve,StepData:V,StepHistoryData:class{constructor(e,t){this.dataType="a5StepHistroy",this.cmd=t,this.list=[];let i=0;for(;i<e.byteLength;){let t=new R(e,i).getUint24("step",!1).getUint32("utc",!1).getSFloat("examount").getFloat("calories",!1).getUint16("exerciseTime").getUint16("distance").getUint8("status").getUint8("batteryVoltage"),n=t.build();i=t.getByteOffset(),this.list.push(n)}}},DailyData:_,HeartRateData:$,HeartRateSectionData:class{constructor(e,t){this.dataType="a5HRSection",this.cmd=t,new R(e).getUint32("utc").getUint16("section1Time").getUint16("section2Time").getUint16("section3Time").build(this),this.section1Time*=2,this.section2Time*=2,this.section3Time*=2}},SleepData:X,SportCaloriesData:ee,SportPaceData:te,SportReportData:ne,SportStatusData:se,DeviceInfoData:oe,DrinkEventReminderSetting:class{constructor(e){this.tag=244,this.dataType="DrinkEventReminder",this.event=e}getBytes(){return(new i).appendUint8(this.tag).appendUint8(1).appendUint8(this.event.startHour).appendUint8(this.event.startMin).appendUint8(this.event.endHour).appendUint8(this.event.endMin).appendUint16(this.event.repeatTime).appendUint8(this.event.vibrationType).appendUint8(this.event.vibrationTime).appendUint8(this.event.vibrationLevel1).appendUint8(this.event.vibrationLevel2).build()}}});function Te(){return(new Date).getTime()/1e3}function Ie(){let e=(new Date).getTimezoneOffset();return e=Math.abs(e),e/60}function Be(){let e=(new Date).getTimezoneOffset(),t=e>0;e=Math.abs(e);let i=(60*(e/60)+e%60)/15;return t&&(i=-i),i+48}var De=[{name:"EnableCharacteristic503",serviceId:N,characteristicId:q,actionType:2},{name:"Disable501",serviceId:N,characteristicId:P,actionType:3},{name:"EnableCharacteristic",serviceId:N,characteristicId:P,actionType:2,await:{timeout:5e3,didReceive(e,i){if("LoginReq"===e.dataType){let n=e;return i.loginReq=e,i.cmdVersion=n.protoVersion,t.Logger.debug("onReadDeviceId",i,i.deviceInfo),i.listeners.onReadDeviceId&&i.listeners.onReadDeviceId(i.deviceInfo.lzDeviceId),t.Logger.warn("context.bindingMode",U(i.deviceInfo),n.bindState),t.errorCode(0)}return t.errorCode(5)}}},{name:"M5LoginBindResp",actionType:1,pushData(e){let t=U(e.deviceInfo);return 5===t&&e.listeners&&e.listeners.onWaitUserSelect&&e.listeners.onWaitUserSelect(Object.assign({},e)),new ye(t)},await:{timeout:45e3,didReceive(e,i){if("Ack"===e.dataType){let i=e;return 227===i.cmd&&0===i.state?t.errorCode(0):1===i.state?t.errorCode(13):t.errorCode(5)}if("PairCode"===e.dataType){let n=e;return i.ext=n,3===U(i.deviceInfo)&&i.listeners.onInputRandomNum(n.randomCode),t.errorCode(0)}return!1}}},{name:"WaitBindResp",actionType:0,when:e=>3===U(e.deviceInfo),await:{dataType:"Ack",timeout:6e4,didReceive:(e,i)=>"Ack"===e.dataType&&(227===e.cmd?t.errorCode(0):t.errorCode(5))}},{name:"BindResponse",actionType:1,pushData(e){let t=0;return t=43521==e.cmdVersion?Be():Ie(),new we(0,Te(),t,S()?1:2,e.userInfo.weight,e.userInfo.height)}}];class Le{constructor(e){this.dataType="userInfo",this.tag=80,e?(this._userInfo=e,this._userInfo.weight=e.weight>0?e.weight:this._userInfo.weight,this._userInfo.weight>300&&(this._userInfo.weight=300),this._userInfo.height=e.height>0?e.height:this._userInfo.height,this._userInfo.height>3&&(this._userInfo.height=3),this._userInfo.targetStep=e.targetStep>0?e.targetStep:this._userInfo.targetStep):this._userInfo={weight:60,height:1.75,targetStep:7e3,gender:1}}getBytes(){let e=this._userInfo,t=L(e.weight),n=L(e.height),s=e.targetStep>0?1:0,a=e.targetStep,r=new i;return r.appendUint8(this.tag).appendUint32(Te(),!1).appendUint32(t).appendUint32(n).appendUint8(s).appendUint32(a).appendUint24(0).appendUint8(0).appendUint8(0).appendUint8(1).appendUint16(0).appendUint16(0),r.build()}}var xe=[{name:"Disable501",serviceId:N,characteristicId:P,actionType:3},{name:"EnableCharacteristic503",serviceId:N,characteristicId:q,actionType:2},{name:"EnableCharacteristic",serviceId:N,characteristicId:P,actionType:2,await:{dataType:"LoginReq",timeout:6e3,didReceive(e,i){if("LoginReq"===e.dataType){let n=e;return i.loginReq=e,i.cmdVersion=n.protoVersion,void 0===n.bindState||null===n.bindState?i.deviceInfo.isBinded=!0:i.deviceInfo.isBinded=3===n.bindState||9===n.bindState,t.errorCode(0)}return!1}}},{name:"ReplyLogin",actionType:1,pushData(e){let t=0;return t=43521==e.cmdVersion?Be():Ie(),new me(!0,Te(),t,S()?1:2)},await:{dataType:"DeviceInfo",didReceive(e,i){if("DeviceInfo"===e.dataType){let n=e;return n&&(n.hardwareVersion&&(i.deviceInfo.hardwareVersion=n.hardwareVersion),n.softVersion&&(i.deviceInfo.softwareVersion=n.softVersion),n.model&&(i.deviceInfo.model=n.model)),t.Logger.debug("context.deviceInfo",i.deviceInfo),t.errorCode(0)}return!1}}},{name:"ReplyDeviceInfo",actionType:1,pushData:e=>new Le(e.userInfo)}];const Re="00002A29-0000-1000-8000-00805F9B34FB",Ce="00002A24-0000-1000-8000-00805F9B34FB",Ae="00002A25-0000-1000-8000-00805F9B34FB",Fe="00002A27-0000-1000-8000-00805F9B34FB",ke="00002A26-0000-1000-8000-00805F9B34FB",Me="00002A28-0000-1000-8000-00805F9B34FB",Ee="00002A23-0000-1000-8000-00805F9B34FB";class Oe{parseAdvertisementData(e,t){return{name:e.name,localName:t.localName,deviceId:e.deviceId,manufacturerData:t.advertisData,serviceUUIDs:t.advertisServiceUUIDs,serviceData:t.serviceData,RSSI:t.RSSI,mac:undefined,isSystemPaired:!1,timestamp:new Date,isRegister:!0}}parseDeviceInfo(e,t){let i={};return i.deviceId=e.deviceId,i.name=e.name,t&&t.size>0&&t.forEach(((e,t)=>{switch(t){case Ae:e&&e.byteLength>=12&&(i.mac=I(e.slice(0,12)));break;case ke:i.firmwareVersion=I(e);break;case Fe:i.hardwareVersion=I(e);break;case Re:i.manufacture=I(e);break;case Me:i.softwareVersion=I(e);break;case Ce:i.model=I(e);break;case Ee:e&&e.byteLength>=6&&(i.lzDeviceId=de(e.slice(0,6)))}})),i}}class He{constructor(e,t){this.dataType="PairCode",this.cmd=t,new R(e).getString("randomCode",6).build(this)}}class Ve{constructor(e,t){this.dataType="Ack",this.cmd=t;let i=new R(e);try{this.state=i.readUint8()}catch(e){}}}var _e=function(e,t,i,n){return new(i||(i=Promise))((function(s,a){function r(e){try{h(n.next(e))}catch(e){a(e)}}function d(e){try{h(n.throw(e))}catch(e){a(e)}}function h(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,d)}h((n=n.apply(e,t||[])).next())}))};class Ne{constructor(e,i){this.buf=e,this.isClear=!1,this.timeout=5e3,this.sid=i||Math.random(),this.trySender=(e,i)=>_e(this,void 0,void 0,(function*(){try{return this.sender(e,i)}catch(e){if(this.isClear)return t.errorCode(4);this.callback(e)}}))}didReceiveData(e){}start(){}resetTimeout(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.timeoutId=setTimeout((()=>{this.callback(t.errorCode(3,this.tag))}),this.timeout)}clear(){this.isClear=!0,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.callback(t.errorCode(4))}callback(e){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),e.success?t.Logger.debug("session 会话结束了",e.data.toString(16),de(e.value)):t.Logger.warn("会话失败了",e),this.completion&&(e.sid=this.sid,this.completion(e),this.completion=null)}}class Pe extends Ne{constructor(e,t){super(e),this.needAck=!1,this.tag=t}start(){return _e(this,void 0,void 0,(function*(){let e=this.decodeToFrames(this.buf);if(e&&e.length<1)return void this.callback(t.errorCode(4,this.tag));this.resetTimeout();let i=this.sendChar;for(let n=0;n<e.length;n++){let s=e[n];try{yield this.trySender(s,i)}catch(e){return void this.callback(t.errorCode(1,this.tag))}}this.needAck||this.callback(t.errorCode(0,this.tag))}))}decodeToFrames(e){let t=e.byteLength,i=Math.ceil(t/this.mtu),n=[];for(let t=0;t<i;t++){let i=t*this.mtu;n.push(e.slice(i,i+this.mtu))}return n}}class ze extends Ne{didReceiveData(e){this.receiveBuf=e.value,this.callback(t.errorCode(0,this.tag,this.receiveBuf))}start(){this.didReceiveData({value:this.buf})}checkFinished(){if(!this.receiveBuf)return!1;if(this.firstFrame.len&&this.firstFrame.len<=this.receiveBuf.byteLength)return!0;if(this.firstFrame.totalFrames){if(1==this.firstFrame.totalFrames)return!0;if(this.preFrame&&this.preFrame.index===this.firstFrame.totalFrames-1)return!0}return!1}decodeFirstFrame(e){throw new Error("如果使用默认的逻辑，则需要实现这个逻辑")}decodeOtherFrame(e){throw new Error("如果使用默认的逻辑，则需要实现这个逻辑")}}class qe{constructor(e){this.sendSessions=[],this.filterServiceIds=[],this.mtu=20,this.context=e}sendData(e,t,i,n){let s=this.createSenderSession(e,t,i);return s.sender=this.sender,s.mtu=this.mtu,s.tag=t,new Promise(((e,t)=>{s.completion=i=>{this.sendingSession=null,n&&n(i),this.tryToDispatchSession(),i.success?e(i):t(i)},this.sendSessions.push(s),this.tryToDispatchSession()}))}clear(){try{this.sendSessions.forEach((e=>{e.clear()})),this.sendSessions.length=0,this.sendingSession&&(this.sendingSession.clear(),this.sendingSession=null)}catch(e){}}updateMtu(e){this.mtu=e}didReceiveData(e){if(this.receiveringSession)this.receiveringSession.didReceiveData(e);else{this.receiveringSession=this.createReceiveSession(e.value),this.receiveringSession.mtu=this.mtu,this.receiveringSession.sender=this.sender;let t=this;this.receiveringSession.completion=e=>{t.receiveringSession&&t.receiveringSession.sid===e.sid&&(t.receiveringSession=null),t.tryToDispatchSession(),t.listener&&t.listener(e)},this.receiveringSession.start()}}createSenderSession(e,t,i){return new Pe(e,t)}createReceiveSession(e){return new ze(e)}tryToDispatchSession(){if(this.sendingSession||0===this.sendSessions.length||this.receiveringSession)return;let e=this.sendSessions.shift();e&&(this.sendingSession=e,e.start())}}var We=function(e,t,i,n){return new(i||(i=Promise))((function(s,a){function r(e){try{h(n.next(e))}catch(e){a(e)}}function d(e){try{h(n.throw(e))}catch(e){a(e)}}function h(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,d)}h((n=n.apply(e,t||[])).next())}))};let Qe=[88,81,82,83,87,114,115,117,127,226,228,229,230,130,131,132,133,134,135,136,137,139,140,142,183,185,20,27,19,18,17,16,103,91,192],Ze=[0,80,85,98,225,123,227,235,26];class je extends ze{constructor(){super(...arguments),this.isLoginReq=!1,this.pageIndex=0,this.sendChar={serviceId:N,charId:z,writeType:0}}didReceiveData(e){let i=new DataView(e.value);if(this.checkIsFirstFrame(i))this.firstFrame=this.decodeFirstFrame(i),this.receiveBuf=this.firstFrame.buf;else{let e=this.decodeOtherFrame(i);if(this.preFrame){if(this.preFrame.index!==e.index-1)return void this.callback(t.errorCode(5,this.tag));this.preFrame=e}else this.preFrame=e;this.receiveBuf=he(this.receiveBuf,e.buf)}this.checkFinished()?(this.receiveBuf=this.receiveBuf.slice(0,this.firstFrame.len-4),Qe.indexOf(this.tag)>=0?this.sendAck():this.callback(t.errorCode(0,this.tag,this.receiveBuf,this.firstFrame.protoVersion))):this.resetTimeout()}checkIsFirstFrame(e){return 128==(128&e.getUint8(0))}decodeFirstFrame(e){let t=new R(e.buffer);this.pageIndex=32767&t.readUint16(!1);let i=t.readUint8();t.readUint8();let n=t.readUint16(!1);i-=2,43521!=n&&(n=0,t.index-=2,i+=2),this.isLoginReq?this.tag=0:(this.tag=t.readUint8(),i-=1);let s=Math.min(i,this.mtu-t.index),a=t.readBuffer(s);return{cmd:this.tag,protoVersion:n,len:i,buf:a}}decodeOtherFrame(e){let t=new R(e.buffer);return{index:t.readUint8(),buf:t.readBuffer(e.buffer.byteLength-1)}}sendAck(){return We(this,void 0,void 0,(function*(){let e=new i;0!=this.firstFrame.protoVersion&&e.appendUint16(this.firstFrame.protoVersion),e.appendUint8(this.tag).appendUint8(1);let n=e.build(),s=re(n),a=new i;a.appendBuffer(n).appendUint32(s),n=a.build(),186===this.tag&&(this.pageIndex=0),e=new i,e.appendUint8(128|this.pageIndex>>8).appendUint8(255&this.pageIndex).appendUint8(n.byteLength).appendUint8(1).appendBuffer(n);let r=e.build();yield this.trySender(r,this.sendChar),this.callback(t.errorCode(0,this.tag,this.receiveBuf,this.firstFrame.protoVersion))}))}}class Ge extends Pe{constructor(){super(...arguments),this.sendChar={serviceId:N,charId:z,writeType:0},this.pageIndex=0,this.protoVersion=0}decodeToFrames(e){let t=e;if(0!=this.protoVersion){let e=new i;e.appendUint16(this.protoVersion),e.appendBuffer(t),t=e.build()}let n=re(t),s=new i;s.appendBuffer(t).appendUint32(n),t=s.build();let a=t.byteLength,r=this.mtu-4,d=new i;d.appendUint8(128|this.pageIndex>>8).appendUint8(255&this.pageIndex).appendUint8(a).appendUint8(1);let h=[];d.appendBuffer(t.slice(0,r)),h.push(d.build());let o=this.mtu-1,p=Math.ceil((a-r)/o);for(let e=0;e<p;e++){let n=new i,s=Math.min(a-16-o*e,o),d=o*e+r;n.appendUint8(e+2),n.appendBuffer(t.slice(d,d+s)),h.push(n.build())}return h}}class Ye extends qe{constructor(){super(...arguments),this.prePageIndex=0,this.protoVersion=43521}didReceiveData(e){if(e.characteristicId==P)if(this.loginReqSession)this.loginReqSession.didReceiveData(e);else{let t=new je(e.value,0);this.loginReqSession=t,t.isLoginReq=!0,t.mtu=this.mtu,t.sender=this.sender,t.completion=e=>{this.protoVersion=e.extra,this.loginReqSession&&this.loginReqSession.pageIndex?this.prePageIndex=this.loginReqSession.pageIndex:this.prePageIndex=0,this.loginReqSession=null,this.listener&&this.listener(e)},t.start()}else if(e.characteristicId==q){if(128&new DataView(e.value).getUint8(0)){t.Logger.debug("chuangjian session",e),this.receiveringSession=this.createReceiveSession(e.value),this.receiveringSession.mtu=this.mtu,this.receiveringSession.sender=this.sender;let i=this;this.receiveringSession.completion=e=>{let n=i.receiveringSession;t.Logger.debug("完成会话",e),i.receiveringSession&&e.sid===i.receiveringSession.sid&&(i.receiveringSession=null),i.tryToDispatchSession(),e.success&&(n.pageIndex&&(i.prePageIndex=n.pageIndex),i.listener&&i.listener(e))},this.receiveringSession.start()}else this.receiveringSession?this.receiveringSession.didReceiveData(e):t.Logger.warn("抛弃未处理的数据",e.characteristicId,f(e.value))}else t.Logger.warn("未处理 cValue",e)}createSenderSession(e,t){let i=new Ge(e);return i.protoVersion=this.protoVersion,l(this.context.deviceInfo)&&225===t?i.pageIndex=0:Ze.indexOf(t)>=0?i.pageIndex=this.prePageIndex:i.pageIndex=0,i}createReceiveSession(e){return new je(e)}}var Je=function(e,t,i,n){return new(i||(i=Promise))((function(s,a){function r(e){try{h(n.next(e))}catch(e){a(e)}}function d(e){try{h(n.throw(e))}catch(e){a(e)}}function h(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,d)}h((n=n.apply(e,t||[])).next())}))};class Ke extends Pe{constructor(){super(...arguments),this.sendChar={serviceId:W,charId:"0000A702-0000-1000-8000-00805F9B34FB",writeType:0},this.sendPackageChar={serviceId:W,charId:"0000A703-0000-1000-8000-00805F9B34FB",writeType:0},this.tag=255}start(){return Je(this,void 0,void 0,(function*(){this.sendHeader()}))}didReceiveData(e){if(e.value&&e.value.byteLength<4)return;if(this.isClear)return;let i=new R(e.value);i.readUint16(),i.readUint8();let n=i.readUint8(),s=0;if(e.value.byteLength>4&&(s=i.readUint8()),0!=s)return t.Logger.error("ota 失败",f(e.value)),void this.handlerErrorCode(s);switch(n){case 2:this.otaParse.parseHeadAck(e.value),this.resetTimeout(),this.sendBlockPackage();break;case 3:this.resetTimeout();let i=this.otaParse.parseDataAck(e.value);this.otaParse.checkDataFinished()?(this.timeout=35e3,this.sendCmd(4)):(this.otaParse.upgrade.onUpgradeProcess(100*i.percent),this.sendBlockPackage());break;case 4:this.sendCmd(5),this.resetTimeout();break;case 5:this.sendCmd(6),this.resetTimeout();break;case 6:return void this.callback(t.errorCode(0,this.tag));default:return void this.callback(t.errorCode(5,this.tag))}}callback(e){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.completion&&(this.otaParse.upgrade.onUpgradeComplete(e.code,e.msg),this.completion(e),this.completion=null)}sendHeader(){return Je(this,void 0,void 0,(function*(){this.resetTimeout();for(let e=0;e<this.otaParse.headList.length;e++){let t=this.otaParse.headList[e];yield this.trySender(t,this.sendChar)}}))}sendBlockPackage(){return Je(this,void 0,void 0,(function*(){if(this.isClear)return;let e=this.otaParse.getData();for(let t=0;t<e.length;t++){let i=e[t];yield this.trySender(i,this.sendPackageChar)}this.sendBlockFinish()}))}sendBlockFinish(){return Je(this,void 0,void 0,(function*(){if(this.isClear)return;let e=this.otaParse.getBlockFinishAck();this.trySender(e,this.sendChar),this.resetTimeout()}))}sendCmd(e){if(this.isClear)return;let t=(new i).appendUint8(e).appendUint8(1).appendUint8(0).build();this.trySender(t,this.sendChar),this.resetTimeout()}handlerErrorCode(e){switch(e){case 6:this.callback(t.errorCode(9,this.tag));break;case 4:this.callback(t.errorCode(16,this.tag));break;case 1:0===this.otaParse.otaVersion?this.callback(t.errorCode(9,this.tag)):this.callback(t.errorCode(5,this.tag));break;default:this.callback(t.errorCode(5,this.tag))}}}class $e extends qe{didReceiveData(e){this.sendingSession&&this.sendingSession.didReceiveData(e)}createSenderSession(e,t,i){let n=new Ke(e);return n.otaParse=t,n}}class Xe{constructor(e,t){this.dataType="finish",this.cmd=t;let i=new R(e);this.reportType=i.readUint8(),this.reportCmd="0x"+this.reportType.toString(16)}}class et{constructor(e,t){this.dataType="charging",this.cmd=t,new R(e).getUint32("utc").getUint8("startBattery").getUint32("endUtc").getUint8("endBattery").build(this)}}class tt{constructor(e,t){this.dataType="brightness",this.cmd=t,new R(e).getUint8("brightnessInDay").getUint8("brightnessInNight").getUint8("enableInNight").getUint8("startHourInNight").getUint8("startMinuteInNight").getUint8("endHourInNight").getUint8("endMinuteInNight").build(this)}}class it{constructor(e,t){this.dataType="sleepReport",this.cmd=t;let i=new R(e).getUint32("sleepUtc").getUint32("awakeUtc").getUint32("durationOfAwake").getUint32("numberOfAwake").getUint32("numberOfEyeMovement").getUint32("timeOfLightSleep").getUint32("timeOfDeepSleep").getUint8("characteristicsOfSleep").getUint8("reside").getUint8("offsetOfSleepReport").getUint8("extFlag").getUint8("totalOfSleepStruct").getUint8("offsetOfSleepStruct");i.build(this);let n=i.readUint8(),s=[];for(let e=0;e<n;e++){let e=i.readUint32(),t=i.readUint32(),n=i.readUint8(),a=i.readUint32();0===a&&(a=(t-e)/60);let r={startUtc:e,endUtc:t,deep:n,duration:a};s.push(r)}this.sleepList=s;let a=this.extFlag;1==(a>>0&1)&&(this.breathScore=i.readUint8()),1==(a>>1&1)&&(this.breathLevel=i.readUint8()),1==(a>>>2&1)&&(this.sleepScore=i.readUint8())}merger(e){return e.sleepList.forEach((e=>{this.sleepList.push(e)})),this}}class nt{constructor(e,t){if(this.dataType="bloodOxygen",this.cmd=t,131===t){let t=new R(e).getUint16("reside").getUint16("offset");t.build(this);let i=t.readUint16(),n=[];for(let e=0;e<i;e++){let e=t.readUint32(),i=t.readUint8(),s=t.readUint8();n.push({utc:e,bloodOxygenValue:i,heartRate:s})}this.list=n}else if(142===t){let t=new R(e);this.reside=t.readUint16();let i=t.readUint16(),n=t.readUint32(),s=5*t.readUint8(),a=[];for(let e=0;e<i;e++){let i=t.readUint8(),r=t.readUint8(),d=t.readUint8(),h=e*s+n;a.push({utc:h,bloodOxygenValue:r,heartRate:d,state:i})}this.list=a}else if(133===t){let t=new R(e).getUint16("reside").getUint16("offset");t.build(this);let i=t.readUint16(),n=[];for(let e=0;e<i;e++){let e=t.readUint32(),i=t.readUint8(),s=t.readUint8();n.push({utc:e,bloodOxygenValue:i,heartRate:s})}this.list=n}}merger(e){return e.list.forEach((e=>{this.list.push(e)})),this.reside=e.reside,this.offset=e.offset,this}}class st{constructor(e,t){this.dataType="dailReport",this.cmd=t;let i=new R(e).getUint8("index");this.count=i.readUint8(),i.getUint8Array("list",this.count).build(this)}}class at{constructor(e,t){this.dataType="meditation",this.cmd=t;let i=new R(e).getUint16("reside").getUint16("offset"),n=i.readUint16(),s=[];for(let e=0;e<n;e++){let e=i.readUint32(),t=i.readUint16();s.push({utc:e,duration:t})}this.list=s,i.build(this)}}class rt{constructor(e,t){this.dataType="generalStepDetail",this.cmd=t;let i=new R(e).getUint32("utc").getUint8("freq").getUint16("reside").getUint16("offset"),n=i.readUint16();i.getUint8Array("list",n).build(this)}}class dt{constructor(e,t){this.dataType="dialInfo",this.tag=185,this.cmd=t,this.state=new R(e).readUint8()}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.state).build()}}class ht{constructor(e,t=0,i=0,n=0,s=0){this.tag=102,this.syncDataType=e,this.flag=t,this.settingType=i,this.param1=n,this.param2=s}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.syncDataType).appendUint32(this.flag).appendUint16(this.settingType).appendUint8(this.param1).appendUint8(this.param2).build()}}class ot{constructor(e,t){this.dataType="AlarmClockSwitch",this.cmd=t,new R(e).getUint8("index").getUint8("enable").build(this)}}var pt=new class{parserBuf(e,i,n){switch(new R(e).readUint8()){case 5:return(new k).parserBuf(e.slice(1));case 10:return(new A).parserBuf(e.slice(1));case 11:return(new C).parserBuf(e.slice(1),n);case 14:return new ot(e.slice(1),14);default:t.Logger.error("未处理的类型")}}};class lt{constructor(e,t){this.dataType="buriedPoint",this.cmd=t;let i=new R(e);this.style=i.readUint8()}}const ct=1050,ut=1e3,gt=1001;class Ut{constructor(e,t,i=1001,n=100){this.actions=e,this.context=t,this.priority=i,this.id=n}}class ft{constructor(e,t,i=1e3,n=200){this.priority=1e3;let s=[];this.priority=i,this.context=t,this.id=n,e.forEach((e=>{let t={name:"push",actionType:1,pushData:()=>e};s.push(t)})),this.actions=s}}class mt{constructor(e){this.rspCode=0,this.dataView=new DataView(e.slice(2)),this.cmd=this.dataView.getUint8(0),this.rspCmd=this.dataView.getUint8(1),this.dataView.byteLength>2&&(this.rspCode=this.dataView.getUint8(2))}}class yt extends mt{constructor(e){if(super(e),this.percent=0,this.currentOffset=this.dataView.getUint32(3,!1)>>>0,this.dataView.byteLength>=8){let e=this.dataView.getUint16(7,!1)>>>0;this.percent=e/1e4}}}class bt extends mt{constructor(e){super(e),this.mtu=Math.max(20,this.dataView.getUint8(3))>>>0,this.maxCacheFrames=this.dataView.getUint8(4)>>>0,this.startOffset=this.dataView.getUint32(5,!1)>>>0,this.currentOffset=this.dataView.getUint32(9,!1)>>>0,this.length=this.dataView.getUint32(13,!1)>>>0}}class wt{constructor(e,i=0){this.willSendSize=0,this.upgrade=e;let n=e.fileBuffer;this.originBuffer=n,this.size=n.byteLength>>>0,this.dataView=new DataView(n),this.mtu=20,this.otaVersion=i,n.byteLength>120?(this.isVilid=!0,this._parseHeadInfo()):(t.Logger.warn("文件不可用"),this.isVilid=!1)}getHeadData(){return this.headList}checkDataFinished(){return this.offset<0?(t.Logger.error("解析的offset出现错误",this.offset),!0):this.offset>=this.size-1}getData(){let e=0,i=[];for(let n=0;n<this.headAck.maxCacheFrames;n++){let s=this.offset+n*this.headAck.mtu,a=Math.min(this.mtu,this.size-s);if(a<=0||s>=this.size){t.Logger.debug("发送完成了");break}e+=a;let r=this.originBuffer.slice(s,s+a);i.push(r)}return this.willSendSize=e,i}getBlockFinishAck(){let e=8;1==this.otaVersion&&(e=12);let t=D(this.originBuffer.slice(this.offset,this.offset+this.willSendSize)),n=new i;return n.appendUint8(3).appendUint8(1).appendUint8(e).appendUint32(this.willSendSize,!1).appendUint32(t,!1),1==this.otaVersion&&n.appendUint32(this.offset,!1),this.willSendSize=0,n.build()}getCmd(e){let t=new Uint8Array(3);return t[0]=e,t[1]=1,t[2]=0,t.buffer}parseHeadAck(e){let i=new bt(e);return 0==this.otaVersion&&(i.mtu=20),this.offset=i.currentOffset,this.headAck=i,this.mtu=i.mtu,t.Logger.warn(i),this.headAck}parseDataAck(e){let t=new yt(e);return this.offset=t.currentOffset,0==this.otaVersion&&(t.percent=this.offset/this.headAck.length),t}parseAck(e){return new mt(e)}_parseHeadInfo(){let e=Math.ceil(103/18)+1,t=[],n=0;for(let s=0;s<e;s++){let a=new i;if(a.appendUint8(2).appendUint8(s+1),0==s)a.appendUint8(120),a.appendBuffer(this.originBuffer.slice(0,17)),n+=17;else{if(s===e-1){let e=this.originBuffer.slice(n,120);a.appendBuffer(e)}else a.appendBuffer(this.originBuffer.slice(n,n+18));n+=18}t.push(a.build())}this.offset=120,this.headList=t}}class vt{constructor(e,t){this.tag=e,this.serviceId=t}getBytes(){return(new i).build()}}class St{constructor(e){this.id=110,this.priority=gt,this.dialPushSetting=e,255!=e.dailType?(this.fileInfo={fileBuffer:e.fileBuf,onUpgradeProcess:i=>{t.Logger.debug("progress ",i),e.onUpgradeProcess&&e.onUpgradeProcess(i)},onUpgradeComplete:(t,i)=>{e.onUpgradeComplete&&e.onUpgradeComplete(t,i)}},this.actions=this.getPushFileActions()):this.actions=this.deleteActions()}deleteActions(){let e=this;return[{name:"发送表盘数据",actionType:1,pushData:t=>e.dialPushSetting,await:{timeout:6e3,didReceive(e,i){if(249===e.cmd){return 1===e.state?t.errorCode(0):t.errorCode(5)}return!0}}}]}getPushFileActions(){let e=this;return[{name:"发送表盘数据",actionType:1,pushData:t=>e.dialPushSetting,await:{timeout:8e3,didReceive(e,i){if(249===e.cmd){return 1===e.state?t.errorCode(0):t.errorCode(5)}return!0}}},{name:"发送表盘文件",actionType:1,pushData(t){let i=new wt(e.fileInfo,1);return new vt(i,W)}},{name:"发送确认",actionType:1,pushData:e=>new H(1),await:{timeout:3e3,didReceive(i,n){if(185===i.cmd){return 2===i.state?t.errorCode(0):(e.responseData=t.errorCode(5),t.errorCode(5))}return!0}}},{name:"收到04",actionType:0,await:{timeout:8e3,didReceive(i,n){if(185===i.cmd){return 4===i.state?t.errorCode(0):(e.responseData=t.errorCode(5),t.errorCode(5))}return!0}}},{name:"收到05",actionType:0,await:{timeout:2e4,didReceive(i,n){if(185===i.cmd){return 5===i.state?t.errorCode(0):(e.responseData=t.errorCode(5),t.errorCode(5))}return!0}}}]}}class Tt{constructor(e,i,n){this.priority=gt,t.Logger.debug("A5GetSettingAction ",e),this.pushData=e,this.dataType=i,this.settingTag=n,this.id=n,this.actions=this.getActions()}getActions(){let e=this;return[{name:"获取设置项",actionType:1,pushData:t=>e.pushData,await:{timeout:4e3,didReceive(i,n){if(i.dataType===e.dataType){if("SettingInfos"!==i.dataType)return e.responseData=t.errorCode(0,i),e.responseData;{let n=i.settings[0];if(n&&n.tag===e.settingTag)return e.responseData=t.errorCode(0,i),e.responseData}}return!1}}}]}}class It{constructor(e){this.priority=gt,this.id=4,this.pushData=e,this.list=[]}get actions(){let e=this;return[{name:"",actionType:1,pushData:t=>e.pushData,await:{timeout:5e3,didReceive:(i,n)=>"EventReminder"===i.dataType&&(e.responseData=t.errorCode(0,i),e.responseData)}}]}}class Bt{constructor(e,t){this.dataType="dialDetail",this.cmd=t;let i=new R(e);this.dialIndex=i.readUint8();let n=i.readUint8();if(n>0){let e=i.readBuffer(n);this.id=I(e)}this.dailType=i.readUint8();let s=i.readUint8();if(s>0){let e=i.readBuffer(s);this.fileName=I(e)}let a=i.readUint8();if(a>0){let e=i.readBuffer(a);this.backgroundImageName=I(e)}}}class Dt{constructor(){this.priority=gt,this.id=6,this.list=[],this.pushData=new ve(12);let e=this;this.dialReportActions=[{name:"发送表盘数据",actionType:1,pushData:t=>e.pushData,await:{timeout:3e3,didReceive:(i,n)=>"dailReport"===i.dataType&&(e.updateDialReport(i),t.errorCode(0))}},{name:"收到完结",actionType:0,await:{timeout:3e3,didReceive:(e,i)=>"finish"===e.dataType&&t.errorCode(0)}}]}get actions(){let e=[...this.dialReportActions];return this.dialDetailActions&&this.dialDetailActions.forEach((t=>{e.push(t)})),e}updateDialReport(e){let i=[],n=this;if(e.list.length>0)for(let s=0;s<e.list.length;s++){let a=e.list[s],r={name:"获取表盘详细数据",actionType:1,pushData:e=>new O(a),await:{timeout:7e3,didReceive:(i,s)=>"dialDetail"===i.dataType&&(n.list.push(i),n.responseData=t.errorCode(0,{index:e.index,list:n.list}),n.responseData)}};i.push(r)}this.dialDetailActions=i}}class Lt{constructor(e,t){this.dataType="stepFreq",this.cmd=t;let i=new R(e).getUint8("sportMode").getUint8("subMode").getUint32("utc").getUint32("utcOffset").getUint16("reside"),n=i.readUint16();i.getUint16Array("list",2*n).build(this),this.utcOffset*=5}}class xt{constructor(e,t){this.dataType="stepFreq",this.cmd=t;let i=new R(e).getUint8("sportMode").getUint8("subMode").getUint32("utc").getUint32("utcOffset").getUint16("reside"),n=i.readUint16();i.getUint16Array("list",2*n).build(this),this.utcOffset*=5}}class Rt{constructor(e){this.priority=0,this.id=55,this.actions=this.getActions(e)}getActions(e){let i=[],n=this;return e.forEach((e=>{i.push({name:"sync",actionType:1,ignoreError:e=>!1,pushData:t=>new ve(e),await:{timeout:8e3,didReceive(i,s){if("finish"===i.dataType){let s=i;return t.Logger.info("收到测试截止符",i),s.reportType!==e&&255!==s.reportType||(n.responseData=t.errorCode(0,i),n.responseData)}return!1}}})})),i}}class Ct{constructor(e){this.tag=181,e?(this.age=e.age||25,this.weight=e.weight||60,this.height=e.height||175,this.gender=e.gender):(this.age=25,this.weight=60,this.height=1.75,this.gender=1)}getBytes(){let e=L(this.weight),t=L(this.height);return(new i).appendUint8(this.tag).appendUint8(this.age).appendUint8(this.gender).appendUint32(e).appendUint32(t).build()}}class At{constructor(){this.priority=1250,this.id=100,this.actions=[{name:"重新登陆",actionType:1,pushData:()=>new E(0),await:{timeout:5e3,didReceive:(e,i)=>"LoginReq"===e.dataType&&t.errorCode(0)}},{name:"绑定方式",actionType:1,pushData:e=>new ye(5),await:{timeout:6e4,didReceive(e,i){if("Ack"===e.dataType){let i=e;return 227===i.cmd&&0===i.state?t.errorCode(0):1===i.state?t.errorCode(13):t.errorCode(5)}return"PairCode"===e.dataType&&t.errorCode(0)}}},{name:"BindResponse",actionType:1,pushData:e=>new we(0,Te(),Be(),S()?1:2,1.75,60)}]}}class Ft{constructor(e,i){this.dataType="standData",this.cmd=i;let n=new R(e),s=n.readUint8();if(1===s){n.readUint8();let t=[],i=(e.byteLength-2)/8;for(let e=0;e<i;e++){let e=n.readUint32(),i=n.readUint32(),s=0;for(let e=0;e<24;e++)1==(i>>e&1)&&(s+=1);t.push({utc:e,originValue:i,duration:s})}this.list=t}else t.Logger.warn("类型未处理 tag subCmd",i,s)}}var kt=[{name:"ReplyReset",actionType:1,pushData:e=>new E(0),await:{dataType:"LoginReq",didReceive(e,i){if("LoginReq"===e.dataType){let n=e;return i.loginReq=e,i.cmdVersion=n.protoVersion,void 0===n.bindState||null===n.bindState?i.deviceInfo.isBinded=!0:i.deviceInfo.isBinded=3===n.bindState||9===n.bindState,t.errorCode(0)}return!1}}},{name:"ReplyLogin",actionType:1,pushData(e){let t=0;return t=43521==e.cmdVersion?Be():Ie(),new me(!0,Te(),t,S()?1:2)},await:{dataType:"DeviceInfo",didReceive(e,i){if("DeviceInfo"===e.dataType){let n=e;return n&&(n.hardwareVersion&&(i.deviceInfo.hardwareVersion=n.hardwareVersion),n.softVersion&&(i.deviceInfo.softwareVersion=n.softVersion),n.model&&(i.deviceInfo.model=n.model)),t.errorCode(0)}return!1}}},{name:"ReplyDeviceInfo",actionType:1,pushData:e=>new Le(e.userInfo)}];class Mt{constructor(e){this.priority=ct,this.id=45,this.context=e;let t=[],i=n;var l;(l=e.deviceInfo)&&l.model&&l.model.indexOf("456B4")>=0&&(i=o),[new F({max:220-(e.userInfo&&e.userInfo.age||20),min:0,enable:!0,minEnable:!1},{max:120,min:0,enable:!1,minEnable:!1}),new C([{tag:32,value:0}]),new k(!0,9,0,18,0,60,127,0,5,9,9),new pe([{index:1,type:3,desc:"",enable:!1,hour:23,minute:0,repeatTime:127,vibrationType:2,vibrationTime:60,vibrationLevel1:9,vibrationLevel2:9}]),new C([{tag:19,enable:!0,startHour:23,startMinute:0,endHour:7,endMinute:0}]),new M(1),new p([n,o,a,s,r,h,d]),new C([{tag:4,value:i}])].forEach((e=>{let i={name:"push",actionType:1,pushData:()=>e};t.push(i)})),this.actions=t}}class Et{constructor(){this.dataMap=new Map}updateData(e,t,i){let n=this.dataMap.get(t);if(n){let t=n.get(i);t?(t=t.merger(e),n.set(i,t)):n.set(i,e)}else n=new Map,n.set(i,e);this.dataMap.set(t,n)}getMergedDataList(e){let t=[],i=this.dataMap.get(e);if(i){for(const[e,n]of i.entries()){t.push(n);break}this.dataMap.delete(e)}return t}getMergedData(e,t){let i=this.dataMap.get(e);return i?i.get(t):null}callbackAllData(){this.dataMap.forEach(((e,t)=>{e.forEach(((e,t)=>{this.lister(e)}))})),this.dataMap.clear()}callbackData(e){let t=this.getMergedDataList(e);t&&t.length>0&&t.forEach((e=>{this.lister(e)}))}receiveAndHandle(e,i){switch(e.dataType){case"EventReminder":{let t=e;return 0===t.events.length?(this.updateData(t,t.dataType,10),this.callbackAllData()):this.updateData(t,t.dataType,10),!0}case"sleepReport":{let i=e;return this.updateData(i,i.dataType,i.sleepUtc),t.Logger.warn("睡眠接收",i.sleepUtc,i.awakeUtc,i.sleepList.length),i.sleepList[i.sleepList.length-1].endUtc===i.awakeUtc&&(t.Logger.warn("睡眠完成",i.sleepUtc,i.awakeUtc,i.sleepList&&i.sleepList.length),this.callbackAllData()),!0}case"bloodOxygen":{let t=e;return this.updateData(t,t.dataType,133),!0}case"a5SportCalories":{let t=e;return this.updateData(t,t.dataType,t.utc),0===t.reside&&this.callbackAllData(),!0}case"a5HR":{let t=e;return 2===t.type&&(this.updateData(t,t.dataType,t.utc),0===t.reside&&this.callbackAllData(),!0)}case"a5SportPace":{let t=e;return this.updateData(t,t.dataType,t.utc),0===t.reside&&this.callbackAllData(),!0}case"finish":return this.callbackAllData(),!1}return!1}}var Ot=function(e,t,i,n){return new(i||(i=Promise))((function(s,a){function r(e){try{h(n.next(e))}catch(e){a(e)}}function d(e){try{h(n.throw(e))}catch(e){a(e)}}function h(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,d)}h((n=n.apply(e,t||[])).next())}))};function Ht(e){if(!e||0===e.byteLength)return 0;let t=new Uint8Array(e),i=0;for(let n=0;n<e.byteLength;n++)i+=t[n]>>>0;return 65535&i}class Vt extends ze{constructor(){super(...arguments),this.pageIndex=0,this.sendChar={serviceId:Z,charId:j,writeType:0}}didReceiveData(e){let i=new DataView(e.value);if(this.checkIsFirstFrame(i))this.firstFrame=this.decodeFirstFrame(i),this.receiveBuf=this.firstFrame.buf;else{let e=this.decodeOtherFrame(i);if(this.preFrame){if(this.preFrame.index!==e.index-1)return void this.callback(t.errorCode(5,this.tag));this.preFrame=e}else this.preFrame=e;this.receiveBuf=he(this.receiveBuf,e.buf)}this.checkFinished()?(this.receiveBuf=this.receiveBuf.slice(0,this.firstFrame.len-2),160===this.tag?this.sendAck():this.callback(t.errorCode(0,this.tag,this.receiveBuf,this.firstFrame.protoVersion))):this.resetTimeout()}checkIsFirstFrame(e){return 1===e.getUint8(0)}decodeFirstFrame(e){let t=new R(e.buffer);this.pageIndex=t.readUint8();let i=t.readUint8();this.tag=t.readUint8();let n=Math.min(i,e.buffer.byteLength-t.index),s=t.readBuffer(n);return{cmd:this.tag,len:i,buf:s}}decodeOtherFrame(e){let t=new R(e.buffer);return{index:t.readUint8(),buf:t.readBuffer(e.buffer.byteLength-1)}}sendAck(){return Ot(this,void 0,void 0,(function*(){let e=new R(this.receiveBuf).readUint8(),n=(new i).appendUint8(192).appendUint8(e).appendUint8(1).build(),s=Ht(n),a=(new i).appendUint8(1).appendUint8(n.byteLength+3).appendUint16(s).build();yield this.trySender(a,this.sendChar),this.callback(t.errorCode(0,this.tag,this.receiveBuf,this.firstFrame.protoVersion))}))}}class _t extends Pe{constructor(e,t){super(e,t),this.sendChar={serviceId:Z,charId:j,writeType:0},this.pageIndex=0,this.protoVersion=0,this.needAck=193!=t}didReceiveData(e){let i=new R(e.value);i.readUint8(),i.readUint8(),i.readUint8(),i.readUint8(),i.readUint8(),this.callback(t.errorCode(0,this.tag))}decodeToFrames(e){let t=e,n=Ht(t),s=new i;s.appendBuffer(t).appendUint16(n),t=s.build();let a=t.byteLength,r=this.mtu-2,d=new i;d.appendUint8(1).appendUint8(a);let h=[];d.appendBuffer(t.slice(0,r)),h.push(d.build());let o=this.mtu-1,p=Math.ceil((a-r)/o);a-=r;for(let e=0;e<p;e++){let n=new i,s=Math.min(a-o*e,o);if(s<=0)break;let d=o*e+r;n.appendUint8(e+2),n.appendBuffer(t.slice(d,d+s)),h.push(n.build())}return h}}class Nt extends qe{didReceiveData(e){if("0000FCCA-0000-1000-8000-00805F9B34FB"==e.characteristicId)t.Logger.warn("未处理数据",e);else if(e.characteristicId==G){let i=new DataView(e.value),n=i.getUint8(2);if(this.sendingSession&&this.sendingSession.tag===n)return void this.sendingSession.didReceiveData(e);1&i.getUint8(0)?(this.receiveringSession=this.createReceiveSession(e.value),this.receiveringSession.mtu=this.mtu,this.receiveringSession.sender=this.sender,this.receiveringSession.completion=e=>{this.receiveringSession&&e.sid===this.receiveringSession.sid&&(this.receiveringSession=null),e.success&&this.listener&&this.listener(e)},this.receiveringSession.start()):this.receiveringSession?this.receiveringSession.didReceiveData(e):t.Logger.warn("抛弃未处理的数据",e.characteristicId,f(e.value))}else e.characteristicId===Y?this.listener&&this.listener(t.errorCode(0,64712,e.value)):t.Logger.warn("未处理 cValue",e)}createSenderSession(e,t){return new _t(e,t)}createReceiveSession(e){return new Vt(e)}}class Pt{constructor(e,t){this.tag=161,this.dataType="GetMsgDetail",this.msgType1=4;let i=new R(e);this.msgType1=i.readUint8(),this.msgId=i.readUint32();let n=(e.byteLength-5)/3;for(let e=0;e<n&&!(e>=3);e++){let e=i.readUint8(),t=0;try{switch(t=i.readUint16(),e){case 2:this.sizeOfSubtitle=t;break;case 3:this.sizeOfContent=t;break;case 4:this.sizeOfContentLengthString=t;break;case 5:this.sizeOfTimeString=t}}catch(e){}}}}class zt{constructor(e,t,i,n,s,a,r){this.tag=193,this.msgType=4,this.serviceId=Z,this.msgId=e,this.count=t,this.index=i,this.subTitleBuf=n,this.contentBuf=s,this.sizeOfContentBuf=a,this.timeBuf=r}getBytes(){let e=(new i).appendUint8(this.tag).appendUint8(this.msgType).appendUint32(this.msgId).appendUint8(this.count).appendUint8(this.index);return this.subTitleBuf&&e.appendUint8(2).appendUint16(this.subTitleBuf.byteLength).appendBuffer(this.subTitleBuf),this.contentBuf&&e.appendUint8(3).appendUint16(this.contentBuf.byteLength+1).appendBuffer(this.contentBuf).appendUint8(0),this.sizeOfContentBuf&&e.appendUint8(4).appendUint16(this.sizeOfContentBuf.byteLength).appendBuffer(this.sizeOfContentBuf),this.timeBuf&&e.appendUint8(5).appendUint16(this.timeBuf.byteLength).appendBuffer(this.timeBuf),e.build()}}class qt{constructor(e){this.priority=ut,this.id=e.msgInfo.msgId,this.actions=this.getActions(e)}getActions(e){let i=this;if(0===e.msgType2){return[{name:"发送消息简介",actionType:1,pushData:t=>e,await:{timeout:5e3,didReceive:(e,n)=>"GetMsgDetail"===e.dataType&&(i.msgDetailReq=e,t.errorCode(0))}},{name:"发送消息详情",actionType:1,pushData(n){let s=i.msgDetailReq,a=w(e.msgInfo.content);return s.sizeOfContent&&a.byteLength>s.sizeOfContent&&(t.Logger.warn("推送消息过大",a.byteLength,s.sizeOfContent),a=a.slice(0,s.sizeOfContent)),new zt(e.msgInfo.msgId,e.count,1,null,a)}}]}return[{name:"发送消息简介",actionType:1,pushData:t=>e}]}}class Wt{constructor(e,t,i){this.dataType="Battery",this.cmd=t;let n=new R(e),s=n.readBuffer(6);if(this.mac=de(s),l(i)){2===n.readUint8()?(this.battery=n.readUint8(),i.battery=this.battery):(this.ischarging=0!==n.readUint8(),i.isCharging=this.ischarging)}else{this.ischarging=0!==n.readUint8();let e=n.readUint16()/1e3;this.battery=function(e,t){let i=4.1,n=3.6;t.model&&(t.model.indexOf("407")>=0||t.model.indexOf("410")>=0?(i=3,n=2.1):t.model.indexOf("405")&&t.softwareVersion.length>=2&&(n=parseInt(t.softwareVersion.substring(1))<=59?3.64:3.55));return e<=n?0:e<i?Math.ceil((e-n)/(i-n)*100):100}(e,i),i.isCharging=this.ischarging,i.battery=this.battery}}}class Qt{constructor(e,i){this.priority=2e3,this.id=255,this.serviceId=e;let n=this;this.actions=[{name:"获取设置项",actionType:4,serviceId:e,characteristicId:i,await:{timeout:3e3,didReceive:(e,i)=>"Battery"!==e.dataType||(n.responseData=t.errorCode(0,e),n.responseData)}}]}}class Zt{constructor(e,t){this.dataType="CallControl",this.tag=160,new R(e).getUint8("msgType").getUint8("controlType").build(this)}}class jt{constructor(e){this.id=194,this.priority=gt,this.dialPushSetting=e,this.actions=this.getPushFileActions()}getPushFileActions(){let e=this;return[{name:"切换表盘",actionType:1,pushData:t=>e.dialPushSetting},{name:"表盘显示信息",actionType:1,pushData(t){let i={tag:10,index:e.dialPushSetting.dailIndex};return new C([i])}}]}}class Gt{constructor(e){this.priority=ct,this.id=45,this.context=e,this.actions=[{name:"Enable701",serviceId:W,characteristicId:Q,actionType:2,when:e=>!(!e.client.serviceMap.get(W)||!l(e.deviceInfo))},{name:"EnableFCC8",serviceId:Z,characteristicId:G,actionType:2,when:e=>!!e.client.serviceMap.get(Z)},{name:"获取电量",actionType:4,serviceId:Z,characteristicId:Y,when:e=>!!e.client.serviceMap.get(Z),await:{didReceive:(e,i)=>"Battery"===e.dataType&&t.errorCode(0)}}]}}class Yt{constructor(e,t){this.tag=26,this.dataType="workStatus",this.cmd=26;let i=new R(e);this.reportType=i.readUint8(),this.workType=i.readUint8();let n=i.readUint8();if(n>0){let e=[];for(let t=0;t<n;t++){let t=i.readUint8(),n=i.readUint32(),s=i.readUint8();e.push({actionType:t,utc:n,ext:s})}this.list=e}}getBytes(){return(new i).appendUint8(this.tag).appendUint8(this.reportType).appendUint8(this.workType).appendUint8(1).build()}}class Jt{constructor(e){this.priority=ct,this.id=4339,this.context=e;let t=[];[new F({max:220-(e.userInfo&&e.userInfo.age||20),min:0,enable:!0,minEnable:!1},{max:120,min:0,enable:!1,minEnable:!1}),new C([{tag:32,value:0}]),new k(!0,9,0,18,0,60,127,0,5,9,9),new pe([{index:1,type:3,desc:"",enable:!1,hour:23,minute:0,repeatTime:127,vibrationType:2,vibrationTime:60,vibrationLevel1:9,vibrationLevel2:9}]),new C([{tag:19,enable:!1,startHour:23,startMinute:0,endHour:7,endMinute:0}]),new M(1),new p([n,o,a,s,r,h,d]),new C([{tag:4,value:n}])].forEach((e=>{let i={name:"push",actionType:1,pushData:()=>e};t.push(i)})),this.actions=t}}class Kt{constructor(e){this.priority=gt,this.id=899,this.pushData=e;let t=this;this.actions=[{name:"设置ACTION",actionType:1,pushData:()=>t.pushData}]}}class $t{constructor(e){this.id=194,this.priority=gt,this.dialPushSetting=e,this.actions=this.getPushFileActions()}getPushFileActions(){let e=this;return[{name:"设置主目标",actionType:1,pushData(t){let i=0;switch(e.dialPushSetting.targetType){case 1:i=1;break;case 2:i=3;break;case 3:i=2}return new C([{tag:15,type:i}])}},{name:"设置目标",actionType:1,pushData:t=>e.dialPushSetting}]}}class Xt{constructor(e){this.id=200,this.priority=ut,this.actions=[{name:"",actionType:e.enable?2:3,serviceId:J,characteristicId:K}]}}class ei{constructor(e,t){this.priority=1100,this.context=e,this.actions=this.getActions(e,t)}getActions(e,i){return[{name:"EnableCharacteristic701",serviceId:W,characteristicId:Q,actionType:2,when:e=>{let i=!!e.client.serviceMap.get(W);return t.Logger.debug("flag1",i),i&&(i=!l(e.deviceInfo)),t.Logger.debug("flag2",i),i}},{name:"push",actionType:1,pushData:()=>{let t=new wt(i,l(e.deviceInfo)?1:0);return new vt(t,W)}}]}}const ti="00002A24-0000-1000-8000-00805F9B34FB",ii="00002A25-0000-1000-8000-00805F9B34FB",ni="00002A23-0000-1000-8000-00805F9B34FB";const si={uuid:N,name:"bracelet",bind:{protocolType:0,actions:De},sync:{protocolType:1,actions:xe},parser:new class{constructor(){this.normalParser=new Oe}parseAdvertisementData(e,t){let i,n=e.name,s=t.localName,a=e.deviceId,r=t.advertisData;if(r&&r.byteLength>=6){let e=r.byteLength;i=de(r.slice(e-6,e)).toUpperCase()}return{name:n,localName:s,deviceId:a,manufacturerData:r,serviceUUIDs:t.advertisServiceUUIDs,serviceData:t.serviceData,RSSI:t.RSSI,mac:i,isSystemPaired:!1,timestamp:new Date,isRegister:!0}}parseDeviceInfo(e,t){let i=this.normalParser.parseDeviceInfo(e,t);if(i.model&&i.model.indexOf("LS-405")>=0){let e=function(e){if(!e||0===e.length)return new ArrayBuffer(0);let t=e.length/2;if(t<1)return new ArrayBuffer(0);let i=new ArrayBuffer(t),n=new DataView(i);for(let i=0;i<t;i++){let t=e.substr(2*i,2),s=parseInt(t,16);n.setUint8(i,s)}return n.buffer}(i.mac);e=function(e){if(!e||0===e.byteLength)return;let t=new DataView(e),i=new ArrayBuffer(e.byteLength),n=new DataView(i);for(let i=0;i<e.byteLength;i++){let s=e.byteLength-i-1;n.setUint8(i,t.getUint8(s))}return n.buffer}(e),i.mac=de(e)}return i.softwareVersion&&(i.softwareVersion=i.softwareVersion.substring(0,4)),i}},dataParser:new class{parseData(e,i,n){let s=e.data,a=e.value;if(t.Logger.debug("parse data ","0x"+s.toString(16),f(a),a.byteLength),i===N)switch(s){case 0:return new fe(a,s,e.extra);case 27:case 81:case 87:return new _(a,s,n.deviceInfo);case 80:return new oe(a,s);case 82:return new X(a,s);case 83:case 229:case 137:case 16:return new $(a,s);case 84:return new V(a,s);case 114:let i=new ne(a,s);return n.lastSportMode=i.sportMode,i;case 115:let r=new $(a,s);return n.lastSportMode&&(r.sportMode=n.lastSportMode),r;case 123:return new He(a,s);case 127:let d=new ee(a,s,n.deviceInfo);return n.lastSportMode&&(d.sportMode=n.lastSportMode),d;case 230:return new ee(a,s,n.deviceInfo);case 225:case 235:return new se(a,s);case 226:let h=new ne(a,s);return n.lastSportMode=h.sportMode,h;case 227:return new Ve(a,s);case 228:return new te(a,s);case 130:return new it(a,s);case 131:case 133:case 142:return new nt(a,s);case 132:return new at(a,s);case 134:case 136:return new rt(a,s);case 135:return new et(a,s);case 186:return new Bt(a,s);case 139:return new Xe(a,s);case 140:return new tt(a,s);case 183:return new st(a,s);case 185:case 249:return new dt(a,s);case 103:return pt.parserBuf(a,s,n.deviceInfo);case 17:case 91:return new lt(a,s);case 18:return new xt(a,s);case 19:return new Lt(a,s);case 20:return new ne(a,s);case 26:return new Yt(a,s);case 88:return new Ft(a,s);case 192:return(new be).parserBuf(a);default:t.Logger.warn("数据未处理"+s)}else if(i===Z)switch(s){case 161:return new Pt(a,s);case 64712:return new Wt(a,s,n.deviceInfo);case 160:return new Zt(a,s)}else if(i===J)return s===K?new $(a,s):(t.Logger.warn("未知数据, 没有处理"+s),null)}createSession(e,t){return e===N?new Ye(t):e===W?new $e(t):e===Z?new Nt(t):void 0}tryToExchangeMutipleAction(e,i){if(249===i.tag){let e=i;return 0===e.dailType||1===e.dailType||255===e.dailType?new St(e):void t.Logger.warn("只能push 本地相册及云端表盘")}if(4===i.tag)return new qt(i);if(240===i.tag){return new Rt([i.syncDataType])}if(247===i.tag&&g(e.deviceInfo)){return new jt(i)}if((163===i.tag||184===i.tag)&&g(e.deviceInfo))return new Kt(i);if(242===i.tag)return new ft([i],e,ct,242);if(165===i.tag&&g(e.deviceInfo)){return new $t(i)}if(65348===i.tag){return new Xt(i)}return new ft([i],e,ct,i.tag)}getSettingMutipleAction(e,i){switch(i){case 0:return new Tt(new ht(11,512),"SettingInfos",21);case 1:return new Tt(new ht(11,256),"SettingInfos",32);case 2:return new Tt(new ht(11,1024),"SettingInfos",22);case 3:return new Tt(new ht(11,1<<25),"SettingInfos",57);case 4:return new It(new ht(10));case 5:return new Tt(new ht(11,1<<24),"SettingInfos",56);case 6:return new Dt;case 7:return c(e.deviceInfo)?new Tt(new ht(11,1<<20),"SettingInfos",48):new Tt(new ht(11,1<<21),"SettingInfos",48);case 8:return new Tt(new ht(11,16),"SettingInfos",19);case 9:return new Tt(new ht(11,64),"SettingInfos",4);case 10:return new Tt(new ht(11,1<<23),"SettingInfos",55);case 12:return new Tt(new ht(11,0,1),"SettingInfos",33);case 13:return new Tt(new ht(11,1<<30),"SettingInfos",58);case 14:return new Tt(new ht(11,1<<27),"SettingInfos",40);case 15:return new Tt(new ht(11,1<<28),"SettingInfos",41);case 16:return new Tt(new ht(11,1<<29),"SettingInfos",42);case 17:return new Tt(new ht(14),"reminder",0);case 18:return new Tt(new ht(11,1<<17),"SettingInfos",37);case 19:return new Tt(new ht(11,32768),"SettingInfos",35);case 20:return new Tt(new ht(11,1<<18),"SettingInfos",38);case 255:return new Qt(Z,Y);default:t.Logger.error("为实现")}}shouldSendConform(e,t){return 26===t.cmd?t:null}syncDataMutipleAction(e){let t=e.deviceInfo;return l(t)&&(t.isBinded||g(t))?new Rt([254]):null}shouldIntervalSyncData(e){return!(!c(e.deviceInfo)&&!u(e.deviceInfo))}syncUserInfoAction(e,t){let i=new Ct(t);return new ft([i],{})}otaAction(e,t){return new ei(e,t)}workedDefaultAction(e){return new Gt(e)}defaultSettingAction(e){return c(e.deviceInfo)?new Mt(e):g(e.deviceInfo)?new Jt(e):void 0}reStartSyncAction(e){return new Ut(kt,e,1250)}reStartBindAction(e){return new At}checkPushData(e,t){return 249===t.tag||4===t.tag||247===t.tag&&g(e.deviceInfo)?1:0===t.tag?2:123===t.tag||192===t.tag||169===t.tag?3:1}getMergeDataManager(e){return new Et}deviceInfoCharacteristics(e){return[ti,ii,ni]}disConnect(e){return new ft([new E(1)],e,2e3,100)}},setUtils:function(t){e=t}};var ai={settingFactory:Se,proto:si};return module.exports={settingFactory:Se,proto:si},ai}));

}, function(modId) {var map = {}; return __REQUIRE__(map[modId], modId); })
return __REQUIRE__(1646653978718);
})()
//miniprogram-npm-outsideDeps=[]
//# sourceMappingURL=index.js.map