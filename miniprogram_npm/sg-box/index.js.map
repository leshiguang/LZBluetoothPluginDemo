{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;;;;AAAA;AACA","file":"index.js","sourcesContent":["!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):(e=\"undefined\"!=typeof globalThis?globalThis:e||self).RollupLearn=t()}(this,(function(){class e{constructor(){this.size=0,this.values=[]}build(){let e=new ArrayBuffer(this.size),t=new DataView(e);return this.values.forEach((({byteOffset:e,method:i,value:n,littleEndian:s,limitSize:r})=>{if(\"setBuffer\"===i){let i=new DataView(n),s=i.byteLength;r&&(s=Math.min(r,s));for(let n=0;n<s;n++)t.setUint8(e+n,i.getUint8(n))}else\"setUint8\"===i?t[i](e,n):\"setInt8\"===i?n>0?t.setUint8(e,255&n):t.setUint8(e,n+256&255):\"setUint24\"===i?s?t.setUint32(e,n):t.setUint32(e,n<<8,!1):t[i](e,n,s)})),e}appendUint8(e){return this.values.push({byteOffset:this.size,method:\"setUint8\",value:e}),this.size++,this}appendUint16(e,t){return this.values.push({byteOffset:this.size,method:\"setUint16\",value:e,littleEndian:t}),this.size+=2,this}appendUint32(e,t){return this.values.push({byteOffset:this.size,method:\"setUint32\",value:e,littleEndian:t}),this.size+=4,this}appendBuffer(e,t){return this.values.push({byteOffset:this.size,method:\"setBuffer\",value:e,limitSize:t}),this.size+=t||e.byteLength,this}appendUint24(e,t){return this.values.push({byteOffset:this.size,method:\"setUint24\",value:e,littleEndian:t}),this.size+=3,this}appendInt8(e){return this.values.push({byteOffset:this.size,method:\"setInt8\",value:e}),this.size++,this}appendInt16(e,t){return this.values.push({byteOffset:this.size,method:\"setInt16\",value:e,littleEndian:t}),this.size+=2,this}appendFloat32(e,t){return this.values.push({byteOffset:this.size,method:\"setFloat32\",value:e,littleEndian:t}),this.size+=4,this}}class t{constructor(){this.tag=10}getBytes(){return(new e).appendUint8(this.tag).build()}}var i=Object.freeze({__proto__:null,FindBox:class{constructor(){this.tag=8}getBytes(){return(new e).appendUint8(this.tag).build()}},SyncBoxData:t,BoxTiming:class{constructor(e,t){this.tag=48,this.mode=0,this.times=t,this.index=e}getBytes(){return(new e).appendUint8(this.tag).appendUint8(this.index).appendUint8(this.times.length).build()}}});var n;var s={errorCode:function(e,t,i,s){return n.errorCode(e,t,i,s)},getDeviceInfo:function(e){return n.getDeviceInfo(e)},Logger:{debug:function(...e){n.Logger.debug(...e)},info:function(...e){n.Logger.info(...e)},warn:function(...e){n.Logger.warn(...e)},error:function(...e){n.Logger.error(...e)}}};function r(e,t){if(!e)return\"\";if(\"string\"==typeof e)return e;let i=Array.prototype.map.call(new Uint8Array(e),(function(e){return(\"00\"+e.toString(16)).slice(-2)}));if(t){let e=[];for(let t=0;t<i.length;t++)e.push(i[i.length-1-t]);return e.join(\"\")}return i.join(\"\")}function a(e){return e.length>16?e:`0000${e}-0000-1000-8000-00805F9B34FB`}function d(e){return function(e){if(!e)return\"\";let t=new Uint8Array(e);var i,n,s,r,a,d;i=\"\",s=t.length,n=0;for(;n<s;)switch((r=t[n++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i+=String.fromCharCode(r);break;case 12:case 13:a=t[n++],i+=String.fromCharCode((31&r)<<6|63&a);break;case 14:a=t[n++],d=t[n++],i+=String.fromCharCode((15&r)<<12|(63&a)<<6|(63&d)<<0)}return i}(e)}wx.getSystemInfoSync();var h=[{name:\"EnableCharacteristic\",serviceId:a(\"FF00\"),characteristicId:a(\"FF01\"),actionType:2},{name:\"SendVerifyCode\",actionType:1,pushData:t=>({getBytes:t=>(new e).appendUint8(163).appendUint8(159).appendUint8(220).appendUint8(231).appendUint8(87).appendUint8(140).appendUint8(86).appendUint8(153).appendUint8(36).appendUint8(170).appendUint8(210).appendUint8(175).appendUint8(250).appendUint8(147).appendUint8(60).appendUint8(158).appendUint8(15).build()}),await:{didReceive(e,t){if(\"VerifyCode\"==e.dataType){return e?s.errorCode(0):s.errorCode(11)}return!0}}},{name:\"ResuestBind\",actionType:1,pushData:t=>({getBytes(t){let i=new e;return i.appendUint8(1),i.build()}}),await:{timeout:3e4,didReceive(e,t){if(\"Bind\"==e.dataType){return e?s.errorCode(0):s.errorCode(11)}return!0}}},{name:\"BindCallback\",actionType:1,pushData:t=>({getBytes(t){let i=new e;return i.appendUint8(3),i.build()}}),await:{didReceive(e,t){if(\"DeviceInfo\"==e.dataType){let i=e;return t.deviceInfo.battery=i.battery,t.deviceInfo.firmwareVersion=i.version+\"\",s.errorCode(0)}return!0}}},{name:\"SyncTime\",actionType:1,pushData:t=>({getBytes(t){let i=new e;return i.appendUint8(5),i.appendUint32((new Date).getTime()/1e3),i.build()}})},{name:\"Reset1\",actionType:1,pushData:t=>({getBytes:t=>(new e).appendUint8(48).appendUint8(1).appendUint8(0).appendUint8(0).appendUint8(0).appendUint8(0).appendUint8(0).appendUint8(0).build()}),await:{didReceive:(e,t)=>49!==e.cmd||s.errorCode(0,e)}},{name:\"Reset2\",actionType:1,pushData:t=>({getBytes:t=>(new e).appendUint8(48).appendUint8(2).appendUint8(0).appendUint8(0).appendUint8(0).appendUint8(0).appendUint8(0).appendUint8(0).build()}),await:{didReceive:(e,t)=>49!==e.cmd||s.errorCode(0,e)}},{name:\"Reset3\",actionType:1,pushData:t=>({getBytes:t=>(new e).appendUint8(48).appendUint8(3).appendUint8(0).appendUint8(0).appendUint8(0).appendUint8(0).appendUint8(0).appendUint8(0).build()}),await:{didReceive:(e,t)=>49!==e.cmd||s.errorCode(0,e)}},{name:\"Reset4\",actionType:1,pushData:t=>({getBytes:t=>(new e).appendUint8(48).appendUint8(4).appendUint8(0).appendUint8(0).appendUint8(0).appendUint8(0).appendUint8(0).appendUint8(0).build()}),await:{didReceive:(e,t)=>49!==e.cmd||s.errorCode(0,e)}}],o=[{name:\"EnableCharacteristic\",serviceId:a(\"FF00\"),characteristicId:a(\"FF01\"),actionType:2},{name:\"SendVerifyCode\",actionType:1,pushData:t=>({getBytes:t=>(new e).appendUint8(163).appendUint8(159).appendUint8(220).appendUint8(231).appendUint8(87).appendUint8(140).appendUint8(86).appendUint8(153).appendUint8(36).appendUint8(170).appendUint8(210).appendUint8(175).appendUint8(250).appendUint8(147).appendUint8(60).appendUint8(158).appendUint8(15).build()}),await:{didReceive(e,t){if(\"VerifyCode\"==e.dataType){return e?s.errorCode(0):s.errorCode(11)}return!0}}},{name:\"BindCallback\",actionType:1,pushData:t=>({getBytes(t){let i=new e;return i.appendUint8(3),i.build()}}),await:{didReceive(e,t){if(\"DeviceInfo\"==e.dataType){let i=e;return t.deviceInfo.battery=i.battery,t.deviceInfo.firmwareVersion=i.version+\"\",s.errorCode(0)}return!0}}},{name:\"SyncTime\",actionType:1,pushData:t=>({getBytes(t){let i=new e;return i.appendUint8(5),i.appendUint32((new Date).getTime()/1e3),i.build()}})}];function u(e){if(!e||0===e.byteLength)return\"\";let t=new DataView(e),i=\"\";for(let e=0;e<t.byteLength;e++)i+=t.getUint8(e).toString(16).padStart(2,\"0\").toUpperCase();return i}const c=\"00002A29-0000-1000-8000-00805F9B34FB\",l=\"00002A24-0000-1000-8000-00805F9B34FB\",p=\"00002A25-0000-1000-8000-00805F9B34FB\",f=\"00002A27-0000-1000-8000-00805F9B34FB\",g=\"00002A26-0000-1000-8000-00805F9B34FB\",y=\"00002A28-0000-1000-8000-00805F9B34FB\",U=\"00002A23-0000-1000-8000-00805F9B34FB\";class m{parseAdvertisementData(e,t){return{name:e.name,localName:t.localName,deviceId:e.deviceId,manufacturerData:t.advertisData,serviceUUIDs:t.advertisServiceUUIDs,serviceData:t.serviceData,RSSI:t.RSSI,mac:undefined,isSystemPaired:!1,timestamp:new Date,isRegister:!0}}parseDeviceInfo(e,t){let i={};return i.deviceId=e.deviceId,i.name=e.name,t&&t.size>0&&t.forEach(((e,t)=>{switch(t){case p:e&&e.byteLength>=12&&(i.mac=d(e.slice(0,12)));break;case g:i.firmwareVersion=d(e);break;case f:i.hardwareVersion=d(e);break;case c:i.manufacture=d(e);break;case y:i.softwareVersion=d(e);break;case l:i.model=d(e);break;case U:e&&e.byteLength>=6&&(i.lzDeviceId=u(e.slice(0,6)))}})),i}}function v(e,t,i){return e?(t.getUint8(i+2)<<16)+(t.getUint8(i+1)<<8)+t.getUint8(i):(t.getUint8(i)<<16)+(t.getUint8(i+1)<<8)+t.getUint8(i+2)}class w{constructor(e,t=0){this.values=[],this.parseSize=0,this.originalBuffer=e,this.index=t,this.parseSize=0,this.dataView=new DataView(e),this.index=t}build(e){if(!this.originalBuffer||this.originalBuffer.byteLength<=0)return null;e||(e={});let t=this.dataView;return this.values.forEach((({byteOffset:i,method:n,key:s,size:a,parseKey:h,littleEndian:o})=>{i+=this.parseSize;try{if(\"getHexString\"===n)e[s]=r(this.originalBuffer.slice(i,i+a));else if(\"getStringByParse\"===n){let t=e[h];this.parseSize+=t,e[s]=d(this.originalBuffer.slice(i,i+t))}else if(\"getString\"===n)e[s]=d(this.originalBuffer.slice(i,i+a));else if(\"getBuffer\"===n)e[s]=this.originalBuffer.slice(i,i+a);else if(\"getUint8\"===n)e[s]=t.getUint8(i);else if(\"Uint24\"===n)e[s]=v(o,t,i);else if(\"Uint8Array\"===n)e[s]=[].slice.call(new Uint8Array(this.originalBuffer.slice(i,i+a)));else if(\"Uint16Array\"===n){let t=[].slice.call(new Uint16Array(this.originalBuffer.slice(i,i+a)));e[s]=o?t:function(e){if(e&&e.length>0){let t=[];for(let i=0;i<e.length;i++){let n=e[i];n=((255&n)<<8)+(n>>8&255),t.push(n)}return t}return[]}(t)}else if(\"SFloat\"===n){let n=t.getUint8(i),r=((15&n)<<8)+t.getUint8(i+1),a=(240&n)>>>4,d=a;(8&a)>0&&(d=a-16);let h=Math.pow(10,d);e[s]=r*h}else if(\"Float\"===n){let n=t.getUint8(i),r=v(o,t,i+1),a=Math.pow(10,(15&n)-16);e[s]=r*a}else e[s]=t[n](i,o)}catch(e){}})),e}getUint24(e,t=!1){return this.values.push({byteOffset:this.index,method:\"Uint24\",key:e,littleEndian:t}),this.index+=3,this}getSFloat(e){return this.values.push({byteOffset:this.index,method:\"SFloat\",key:e}),this.index+=2,this}getFloat(e,t=!1){return this.values.push({byteOffset:this.index,method:\"Float\",key:e,littleEndian:t}),this.index+=4,this}getUint8Array(e,t){return this.values.push({byteOffset:this.index,size:t,method:\"Uint8Array\",key:e}),this.index+=t,this}getUint16Array(e,t,i=!1){return this.values.push({byteOffset:this.index,size:t,method:\"Uint16Array\",key:e,littleEndian:i}),this.index+=t,this}getUint8(e){return this.values.push({byteOffset:this.index,method:\"getUint8\",key:e}),this.index++,this}getUint16(e,t=!1){return this.values.push({byteOffset:this.index,method:\"getUint16\",key:e,littleEndian:t}),this.index+=2,this}getUint32(e,t=!1){return this.values.push({byteOffset:this.index,method:\"getUint32\",key:e,littleEndian:t}),this.index+=4,this}getBuffer(e,t){return this.values.push({byteOffset:this.index,size:t,method:\"getBuffer\",key:e}),this.index+=t,this}getByteOffset(){return this.index}getString(e,t){return this.values.push({byteOffset:this.index,size:t,method:\"getString\",key:e}),this.index+=t,this}getHexString(e,t){return this.values.push({byteOffset:this.index,size:t,method:\"getHexString\",key:e}),this.index+=t,this}getStringSizeByParse(e,t){return this.values.push({byteOffset:this.index,parseKey:t,method:\"getStringByParse\",key:e}),this}getIndex(){return this.index}readUint8(){let e=this.index;return this.index+=1,this.dataView.getUint8(e)}readUint16(e=!1){let t=this.index;return this.index+=2,this.dataView.getUint16(t,e)}readInt16(e=!1){let t=this.index;return this.index+=2,this.dataView.getInt16(t,e)}readUint24(e=!1){let t=this.index;return this.index+=3,v(e,this.dataView,t)}readUint32(e=!1){let t=this.index;return this.index+=4,this.dataView.getUint32(t,e)}readInt32(e=!1){let t=this.index;return this.index+=4,this.dataView.getInt32(t,e)}readSfloat(){let e=this.index,t=this.dataView;this.index+=2;let i=t.getUint8(e),n=(240&i)>>>4,s=n;return(8&n)>0&&(s=n-16),(((15&i)<<8)+t.getUint8(e+1))*Math.pow(10,s)}readFloat(e=!1){let t=this.index;this.index+=4;let i=this.dataView.getUint8(t);return v(e,this.dataView,t+1)*Math.pow(10,(15&i)-16)}readString(e){return d(this.readBuffer(e))}readBuffer(e){let t=this.index;return this.index+=e,this.dataView.buffer.slice(t,t+e)}}class S{constructor(e,t){this.dataType=\"VerifyCode\",this.cmd=t;let i=new w(e);this.result=176==i.readUint8()}}class b{constructor(e,t){this.dataType=\"Bind\",this.cmd=t;let i=new w(e);this.result=1==i.readUint8()}}var D=function(e,t,i,n){return new(i||(i=Promise))((function(s,r){function a(e){try{h(n.next(e))}catch(e){r(e)}}function d(e){try{h(n.throw(e))}catch(e){r(e)}}function h(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,d)}h((n=n.apply(e,t||[])).next())}))};class B{constructor(e,t){this.buf=e,this.isClear=!1,this.timeout=5e3,this.sid=t||Math.random(),this.trySender=(e,t)=>D(this,void 0,void 0,(function*(){try{return this.sender(e,t)}catch(e){if(this.isClear)return s.errorCode(4);this.callback(e)}}))}didReceiveData(e){}start(){}resetTimeout(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.timeoutId=setTimeout((()=>{this.callback(s.errorCode(3,this.tag))}),this.timeout)}clear(){this.isClear=!0,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.callback(s.errorCode(4))}callback(e){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),e.success?s.Logger.debug(\"session 会话结束了\",e.data.toString(16),u(e.value)):s.Logger.warn(\"会话失败了\",e),this.completion&&(e.sid=this.sid,this.completion(e),this.completion=null)}}class x extends B{constructor(e,t){super(e),this.needAck=!1,this.tag=t}start(){return D(this,void 0,void 0,(function*(){let e=this.decodeToFrames(this.buf);if(e&&e.length<1)return void this.callback(s.errorCode(4,this.tag));this.resetTimeout();let t=this.sendChar;for(let i=0;i<e.length;i++){let n=e[i];try{yield this.trySender(n,t)}catch(e){return void this.callback(s.errorCode(1,this.tag))}}this.needAck||this.callback(s.errorCode(0,this.tag))}))}decodeToFrames(e){let t=e.byteLength,i=Math.ceil(t/this.mtu),n=[];for(let t=0;t<i;t++){let i=t*this.mtu;n.push(e.slice(i,i+this.mtu))}return n}}class F extends B{didReceiveData(e){this.receiveBuf=e.value,this.callback(s.errorCode(0,this.tag,this.receiveBuf))}start(){this.didReceiveData({value:this.buf})}checkFinished(){if(!this.receiveBuf)return!1;if(this.firstFrame.len&&this.firstFrame.len<=this.receiveBuf.byteLength)return!0;if(this.firstFrame.totalFrames){if(1==this.firstFrame.totalFrames)return!0;if(this.preFrame&&this.preFrame.index===this.firstFrame.totalFrames-1)return!0}return!1}decodeFirstFrame(e){throw new Error(\"如果使用默认的逻辑，则需要实现这个逻辑\")}decodeOtherFrame(e){throw new Error(\"如果使用默认的逻辑，则需要实现这个逻辑\")}}class I extends F{constructor(){super(...arguments),this.sendChar={serviceId:a(\"FF00\"),charId:a(\"FF01\"),writeType:0}}didReceiveData(e){this.receiveBuf=e.value;let t=new DataView(e.value),i=new w(t.buffer);if(7==i.readUint8()){let e=i.readUint8();this.tag=i.readUint8(),this.receiveBuf=i.readBuffer(e-1),this.callback(s.errorCode(0,this.tag,this.receiveBuf))}}}class T extends x{constructor(){super(...arguments),this.sendChar={serviceId:a(\"FF00\"),charId:a(\"FF02\"),writeType:0}}decodeToFrames(t){let i=t.byteLength,n=new e;n.appendUint8(7),n.appendUint8(i),n.appendBuffer(t);let s=n.build(),r=this.sumCode(s);return n=new e,n.appendBuffer(s),n.appendUint8(r),[n.build()]}sumCode(e){let t=0;if(e){let i=new DataView(e);for(let e=0;e<i.byteLength;e++)t=i.getUint8(e)+t&255}return t=1+~t&255,t}}class C extends class{constructor(e){this.sendSessions=[],this.filterServiceIds=[],this.mtu=20,this.context=e}sendData(e,t,i,n){let s=this.createSenderSession(e,t,i);return s.sender=this.sender,s.mtu=this.mtu,s.tag=t,new Promise(((e,t)=>{s.completion=i=>{this.sendingSession=null,n&&n(i),this.tryToDispatchSession(),i.success?e(i):t(i)},this.sendSessions.push(s),this.tryToDispatchSession()}))}clear(){try{this.sendSessions.forEach((e=>{e.clear()})),this.sendSessions.length=0,this.sendingSession&&(this.sendingSession.clear(),this.sendingSession=null)}catch(e){}}updateMtu(e){this.mtu=e}didReceiveData(e){if(this.receiveringSession)this.receiveringSession.didReceiveData(e);else{this.receiveringSession=this.createReceiveSession(e.value),this.receiveringSession.mtu=this.mtu,this.receiveringSession.sender=this.sender;let t=this;this.receiveringSession.completion=e=>{t.receiveringSession&&t.receiveringSession.sid===e.sid&&(t.receiveringSession=null),t.tryToDispatchSession(),t.listener&&t.listener(e)},this.receiveringSession.start()}}createSenderSession(e,t,i){return new x(e,t)}createReceiveSession(e){return new F(e)}tryToDispatchSession(){if(this.sendingSession||0===this.sendSessions.length||this.receiveringSession)return;let e=this.sendSessions.shift();e&&(this.sendingSession=e,e.start())}}{didReceiveData(e){this.receiveringSession=this.createReceiveSession(e.value),this.receiveringSession.mtu=this.mtu,this.receiveringSession.sender=this.sender;let t=this;this.receiveringSession.completion=e=>{t.receiveringSession&&t.receiveringSession.sid===e.sid&&(t.receiveringSession=null),t.tryToDispatchSession(),t.listener&&e.success&&t.listener(e)},this.receiveringSession.start()}createSenderSession(e){return new T(e)}createReceiveSession(e){return new I(e)}}class z{constructor(e,t){this.dataType=\"FindBox\",this.cmd=t,this.result=!0}}class k{constructor(e,t){this.dataType=\"BoxTiming\",this.cmd=t;let i=new w(e);this.result=1==i.readUint8()}}class R{constructor(e,t){this.dataType=\"DeviceInfo\",this.cmd=t;let i=new w(e);this.battery=i.readUint8(),this.version=i.readUint16(),this.magic=i.readBuffer(8)}}class A{constructor(e,t){this.dataType=\"SyncBoxData\",this.boxDatas=[],this.dataIndex=0,this.size=0,this.finish=!1,this.parseData(e,t)}parseData(e,t){this.cmd=t;let i=new w(e),n={},s=i.readUint8();this.size=s,console.log(\"size:\"+this.size),n.size=this.size,n.status=i.readUint8(),n.utc=i.readInt32(),n.cellIndex=i.readUint8(),this.boxDatas.length<this.size&&this.boxDatas.push(n)}isFull(){return this.size==this.boxDatas.length}}class V{constructor(e){this.priority=1001,this.syncData=null,this.dialPushSetting=e,this.actions=this.syncActions()}syncActions(){let t=this;return[{name:\"同步数据\",actionType:1,pushData:e=>(console.log(\"同步数据\"),t.dialPushSetting),await:{didReceive(e,i){if(console.log(\"full\"+e),50===e.cmd){let i=e;return!i.isFull()||(t.syncData=i,t.responseData=s.errorCode(0,e),t.responseData)}return!0}}},{when:e=>0!=t.syncData.size,name:\"同步数据接受完成反馈\",actionType:1,pushData:i=>({getBytes:i=>(console.log(\"同步数据接受完成反馈\"),(new e).appendUint8(11).appendUint8(t.syncData.size).build())})}]}}class O{constructor(e){this.priority=1001,this.dialPushSetting=e,this.actions=this.syncActions()}syncActions(){let t=this,i=[];return this.dialPushSetting.times.length>0?this.dialPushSetting.times.forEach(((n,r)=>{i.push({name:\"药盒定时\"+r,actionType:1,pushData:i=>({getBytes(i){let s=new e;s.appendBuffer(t.dialPushSetting.getBytes()),s.appendUint8(r+1);let a=60*n.hour*60+60*n.min+n.sec;if(s.appendUint8(a/65536),s.appendUint8(a%65536/256),s.appendUint8(a%256),0==t.dialPushSetting.mode){let e=0;n.weeks.forEach((t=>{e|=t})),s.appendUint8(e)}else{let e=128|127&t.dialPushSetting.interval;s.appendUint8(e)}return s.build()}}),await:{didReceive:(e,i)=>49!==e.cmd||(console.log(\"index:\"+r+\"length\"+t.dialPushSetting.times.length),r==t.dialPushSetting.times.length-1?(t.responseData=s.errorCode(0,e),t.responseData):s.errorCode(0,e))}})})):i.push({name:\"取消定时\",actionType:1,pushData:i=>({getBytes(i){let n=new e;return n.appendBuffer(t.dialPushSetting.getBytes()),n.appendUint8(0),n.appendUint8(0),n.appendUint8(0),n.appendUint8(0),n.appendUint8(0),n.build()}}),await:{didReceive:(e,t)=>49!==e.cmd||s.errorCode(0,e)}}),i}}const E={uuid:\"0000FF00-0000-1000-8000-00805F9B34FB\",name:\"box\",bind:{protocolType:0,actions:h},sync:{protocolType:1,actions:o},parser:new class extends m{constructor(){super(...arguments),this.normalParse=new m}parseAdvertisementData(e,t){let i=e.name,n=t.localName,s=e.deviceId,r=t.advertisData;if(r&&r instanceof ArrayBuffer){let e=new w(r);e.readUint16();let a=u(e.readBuffer(6));return{name:i,localName:n,deviceId:s,manufacturerData:r,serviceUUIDs:t.advertisServiceUUIDs,serviceData:t.serviceData,RSSI:t.RSSI,mac:a,isSystemPaired:!1,timestamp:new Date,isRegister:!0,model:\"PB1\"}}}parseDeviceInfo(e,t){return Object.assign(Object.assign({},this.normalParse.parseDeviceInfo(e,t)),{model:\"PB1\"})}},dataParser:new class{parseData(e,t,i){let n=e.data,a=e.value;switch(s.Logger.debug(\"parse data\",n,r(a)),n){case 164:return new S(a,n);case 2:return new b(a,n);case 4:return new R(a,n);case 9:return new z(a,n);case 49:return new k(a,n);case 50:this.syncData?this.syncData.parseData(a,n):this.syncData=new A(a,n);let e=this.syncData;return this.syncData.isFull()&&(this.syncData=null),e;default:throw new Error(\"未知数据, 没有处理\"+n)}}tryToExchangeMutipleAction(e,t){if(10===t.tag){return new V(t)}if(48==t.tag){return new O(t)}}checkPushData(e,t){return 10===t.tag||48==t.tag?1:0}createSession(e){if(a(\"FF00\")===e)return new C}syncDataMutipleAction(e){return new V(new t)}shouldIntervalSyncData(e){return!0}},setUtils:function(e){n=e}};var P={settingFactory:i,proto:E};return module.exports={settingFactory:i,proto:E},P}));\n"]}